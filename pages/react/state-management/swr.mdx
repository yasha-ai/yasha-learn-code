# SWR: Легковесное серверное состояние

SWR (Stale-While-Revalidate) — это библиотека от команды Vercel (создателей Next.js) для получения данных. Название происходит от стратегии HTTP-кеширования: сначала вернуть данные из кеша (stale), затем отправить запрос на обновление (revalidate) и в конце вернуть актуальные данные.

### Ключевые особенности

SWR очень похож на TanStack Query, но он гораздо меньше по размеру и сфокусирован на простоте.

```mermaid
graph LR
    Cache[Кеш] -- "1. Сразу отдаем старое" --> UI[Интерфейс]
    UI -- "2. В фоне делаем запрос" --> API[API]
    API -- "3. Обновляем кеш" --> Cache
    Cache -- "4. UI обновляется сам" --> UI
```

### Преимущества SWR

- **Минимализм:** Практически не требует настройки.
- **Интеграция с Next.js:** Работает идеально "из коробки".
- **Фоновые обновления:** Автоматически обновляет данные при возвращении фокуса на вкладку.

### Сравнение: SWR vs TanStack Query

| Характеристика | SWR | TanStack Query |
| :--- | :--- | :--- |
| **Размер** | Очень маленький | Средний |
| **Мутации** | Базовые | Продвинутые |
| **DevTools** | Нет официальных | Есть |
| **Сложные сценарии** | Требуют кода | Встроены |

SWR — отличный выбор, если вам нужно просто и быстро добавить кеширование запросов без переусложнения.

---

import { Playground } from '@/components/Playground';

## Интерактивный пример

Пример использования SWR для загрузки данных профиля пользователя GitHub.

<Playground
  template="vite-react"
  files={{
    'App.jsx': `import React from 'react';
import useSWR from 'swr';

// Fetcher — это просто обертка над обычным fetch
const fetcher = (...args) => fetch(...args).then(res => res.json());

const Profile = () => {
  const { data, error, isLoading } = useSWR('https://api.github.com/users/vercel', fetcher);

  if (error) return <div>Ошибка загрузки</div>;
  if (isLoading) return <div>Загрузка...</div>;

  return (
    <div style={{ textAlign: 'center', padding: '20px' }}>
      <img src={data.avatar_url} width="100" style={{ borderRadius: '50%' }} />
      <h1>{data.name}</h1>
      <p>{data.bio}</p>
      <strong>Подписчиков: {data.followers}</strong>
    </div>
  );
};

export default function App() {
  return <Profile />;
}`,
  }}
/>
