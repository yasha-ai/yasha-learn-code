# TanStack Query: –°–µ—Ä–≤–µ—Ä–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

TanStack Query (—Ä–∞–Ω–µ–µ –∏–∑–≤–µ—Å—Ç–Ω—ã–π –∫–∞–∫ React Query) ‚Äî —ç—Ç–æ –º–æ—â–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º (–∑–∞–ø—Ä–æ—Å–∞–º–∏ –∫ API, –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π).

### –ü–æ—á–µ–º—É –Ω–µ useEffect?

–ú–Ω–æ–≥–∏–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `useEffect` –∏ `useState` –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø—Ä–æ–±–ª–µ–º–∞–º:
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è.
- –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤.
- –°–ª–æ–∂–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ—à–∏–±–æ–∫.
- –ü—Ä–æ–±–ª–µ–º—ã —Å "–ø—Ä–æ—Ç—É—Ö–∞–Ω–∏–µ–º" –¥–∞–Ω–Ω—ã—Ö (stale data).

### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –¥–∞–Ω–Ω—ã—Ö

```mermaid
graph TD
    Fetch[–ó–∞–ø—Ä–æ—Å –¥–∞–Ω–Ω—ã—Ö] --> Loading[–°—Ç–∞—Ç—É—Å Loading]
    Loading --> Success[–°—Ç–∞—Ç—É—Å Success + –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ]
    Success --> Stale[–î–∞–Ω–Ω—ã–µ —É—Å—Ç–∞—Ä–µ–ª–∏ —á–µ—Ä–µ–∑ X —Å–µ–∫]
    Stale --> Refetch[–§–æ–Ω–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ]
    Loading --> Error[–°—Ç–∞—Ç—É—Å Error + Retry]
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

1.  **Caching:** –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ø–∞–º—è—Ç–∏ –∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ.
2.  **Deduping:** –ï—Å–ª–∏ –¥–≤–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∑–∞–ø—Ä–∞—à–∏–≤–∞—é—Ç –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ –¥–∞–Ω–Ω—ã–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ, –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å.
3.  **Automatic Refetch:** –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ —Ñ–æ–∫—É—Å–∞ –æ–∫–Ω–∞ –∏–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–µ—Ç–∏.
4.  **Pagination & Infinite Scroll:** –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∑–∞–≥—Ä—É–∑–∫–∏.

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–º–∏ —Å—Ç–µ–π—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä–∞–º–∏

TanStack Query —É–ø—Ä–∞–≤–ª—è–µ—Ç **—Å–µ—Ä–≤–µ—Ä–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º** (—Ç–æ, —á—Ç–æ –ª–µ–∂–∏—Ç –≤ –ë–î). Zustand –∏–ª–∏ Redux –ª—É—á—à–µ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è **–∫–ª–∏–µ–Ω—Ç—Å–∫–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è** (–æ—Ç–∫—Ä—ã—Ç–∞ –ª–∏ –º–æ–¥–∞–ª–∫–∞, —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ–∏—Å–∫–∞).

---

omponents/Playground';/d

## –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –ø—Ä–∏–º–µ—Ä

–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—É–±–ª–∏—á–Ω—ã–π API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, –∫–∞–∫ –ø—Ä–æ—Å—Ç–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ—à–∏–±–∫–∏.

<Playground
  template="vite-react"
  files={{
    'App.jsx': `import React from 'react';
import { QueryClient, QueryClientProvider, useQuery } from '@tanstack/react-query';

const queryClient = new QueryClient();

const UserProfile = () => {
  const { isLoading, error, data, isFetching } = useQuery({
    queryKey: ['repoData'],
    queryFn: () =>
      fetch('https://api.github.com/repos/TanStack/query').then((res) =>
        res.json(),
      ),
  });

  if (isLoading) return '–ó–∞–≥—Ä—É–∑–∫–∞...';

  if (error) return '–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: ' + error.message;

  return (
    <div>
      <h1>{data.name}</h1>
      <p>{data.description}</p>
      <strong>üëÄ {data.subscribers_count}</strong>{' '}
      <strong>‚ú® {data.stargazers_count}</strong>{' '}
      <strong>üç¥ {data.forks_count}</strong>
      <div>{isFetching ? '–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ —Ñ–æ–Ω–µ...' : ''}</div>
    </div>
  );
};

export default function App() {
  return (
    <QueryClientProvider client={queryClient}>
      <div style={{ padding: '20px' }}>
        <UserProfile />
      </div>
    </QueryClientProvider>
  );
}`,
  }}
/>
