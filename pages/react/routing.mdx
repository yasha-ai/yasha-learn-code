## React: React Router: Навигация в Одностраничных Приложениях

React Router — это стандартная библиотека для маршрутизации в одностраничных приложениях (SPA) на React. Она позволяет синхронизировать UI приложения с URL-адресом, обеспечивая бесшовную навигацию без перезагрузки страницы, что является ключевой особенностью SPA. Благодаря React Router пользователи могут делиться URL-адресами конкретных страниц, использовать кнопки "назад" и "вперед" в браузере, как в традиционных многостраничных приложениях.

### Концепция

В основе React Router лежат три компонента:
1.  **Маршрутизаторы (Routers)**: Например, `BrowserRouter` (для веб-приложений) или `HashRouter`. Они оборачивают все приложение и предоставляют контекст маршрутизации.
2.  **Маршруты (Routes)**: Определяют соответствие между URL-адресом и React-компонентом, который должен быть отрендерен.
3.  **Навигация (Navigation)**: Компоненты вроде `Link` и хуки типа `useNavigate` позволяют пользователям перемещаться по приложению.

### Базовый Пример

Сначала установим `react-router-dom`:
```bash
npm install react-router-dom@6
```

Теперь создадим простое приложение с несколькими страницами и навигацией.

```jsx
// src/App.jsx
import React from 'react';
import { BrowserRouter, Routes, Route, Link } from 'react-router-dom';

// Компоненты страниц
const HomePage = () => <h2>Добро пожаловать!</h2>;
const AboutPage = () => <h2>О нас</h2>;
const ContactPage = () => <h2>Контакты</h2>;
const NotFoundPage = () => <h2>404 - Страница не найдена</h2>;

function App() {
  return (
    <BrowserRouter>
      <nav>
        <Link to="/">Главная</Link> |{' '}
        <Link to="/about">О нас</Link> |{' '}
        <Link to="/contact">Контакты</Link>
      </nav>

      <Routes>
        {/* Route с exact был заменен на автоматическое точное совпадение в v6 */}
        <Route path="/" element={<HomePage />} />
        <Route path="/about" element={<AboutPage />} />
        <Route path="/contact" element={<ContactPage />} />
        {/* Маршрут с "*" ловит все несовпадающие URL-адреса для 404 страницы */}
        <Route path="*" element={<NotFoundPage />} />
      </Routes>
    </BrowserRouter>
  );
}

export default App;
```

В этом примере `BrowserRouter` оборачивает все приложение. `Link` используется для декларативной навигации. `Routes` содержит все определения `Route`, где каждый `Route` связывает `path` с `element` (компонентом).

### Хуки (Hooks) React Router

React Router v6 предоставляет мощные хуки для работы с маршрутизацией:

#### 1. `useParams`

Для получения динамических параметров из URL.

```jsx
// src/components/UserPage.jsx
import React from 'react';
import { useParams } from 'react-router-dom';

const UserPage = () => {
  const { userId } = useParams(); // Извлекаем userId из URL, например /users/123
  return <h3>Профиль пользователя: {userId}</h3>;
};

// В App.jsx добавить маршрут:
// <Route path="/users/:userId" element={<UserPage />} />
// И ссылку: <Link to="/users/1">Пользователь 1</Link>
```

#### 2. `useNavigate`

Для программной навигации (например, после отправки формы).

```jsx
// src/components/Dashboard.jsx
import React from 'react';
import { useNavigate } from 'react-router-dom';

const Dashboard = () => {
  const navigate = useNavigate();

  const handleLogout = () => {
    // Выполняем действия по выходу пользователя
    alert('Вы вышли из системы!');
    navigate('/'); // Перенаправляем на главную страницу
  };

  return (
    <div>
      <h2>Панель управления</h2>
      <button onClick={handleLogout}>Выйти</button>
    </div>
  );
};

// В App.jsx добавить маршрут:
// <Route path="/dashboard" element={<Dashboard />} />
// И ссылку: <Link to="/dashboard">Панель управления</Link>
```

#### 3. `useLocation`

Предоставляет информацию о текущем URL.

```jsx
// src/components/LocationDisplay.jsx
import React from 'react';
import { useLocation } from 'react-router-dom';

const LocationDisplay = () => {
  const location = useLocation(); // Возвращает объект { pathname, search, hash, state, key }
  return <p>Текущий путь: <code>{location.pathname}</code></p>;
};

// Можно использовать в любом компоненте внутри BrowserRouter, например, в футере.
// <LocationDisplay />
```

### Оптимизация: Ленивая Загрузка (Code Splitting)

React Router прекрасно интегрируется с `React.lazy` и `Suspense` для ленивой загрузки компонентов, что улучшает производительность, разделяя бандл приложения на более мелкие части.

```jsx
// src/App.jsx (модифицированный фрагмент)
import React, { lazy, Suspense } from 'react';
import { BrowserRouter, Routes, Route, Link } from 'react-router-dom';

// Ленивая загрузка компонентов
const AboutPage = lazy(() => import('./pages/AboutPage'));
const ContactPage = lazy(() => import('./pages/ContactPage'));
// Предположим, что HomePage и NotFoundPage достаточно малы и загружаются сразу

const HomePage = () => <h2>Добро пожаловать!</h2>;
const NotFoundPage = () => <h2>404 - Страница не найдена</h2>;

function App() {
  return (
    <BrowserRouter>
      {/* ... навигация ... */}
      <nav>
        <Link to="/">Главная</Link> |{' '}
        <Link to="/about">О нас (lazy)</Link> |{' '}
        <Link to="/contact">Контакты (lazy)</Link>
      </nav>

      <Suspense fallback={<div>Загрузка...</div>}>
        <Routes>
          <Route path="/" element={<HomePage />} />
          <Route path="/about" element={<AboutPage />} />
          <Route path="/contact" element={<ContactPage />} />
          <Route path="*" element={<NotFoundPage />} />
        </Routes>
      </Suspense>
    </BrowserRouter>
  );
}
// Необходимо создать файлы src/pages/AboutPage.jsx и src/pages/ContactPage.jsx
// export const AboutPage = () => <h2>О нас</h2>;
// export const ContactPage = () => <h2>Контакты</h2>;
```
`Suspense` показывает резервный контент (`fallback`) пока ленивый компонент загружается.

### Типичные Ошибки

1.  **Забыли `BrowserRouter`**: Все компоненты `Link`, `Routes`, `Route` и хуки должны быть внутри `BrowserRouter`.
2.  **Неправильное использование `Routes`**: Все `Route` должны быть прямыми потомками `Routes`.
3.  **Использование `<a>` вместо `Link`**: Для внутренней навигации всегда используйте `Link`. Тег `<a>` вызывает полную перезагрузку страницы.
4.  **Отсутствие `*` для 404**: Если нет маршрута с `path="*"` в конце `Routes`, пользователи будут видеть пустую страницу при ошибках URL.
5.  **Вложенные маршруты**: Для вложенных маршрутов родительский `Route` должен заканчиваться `/*` или `/*` (для v6, это уже не обязательно, но полезно помнить о вложенных `Routes` и `Outlet`).

### Практика

Создайте приложение с такими маршрутами:
-   `/` (Главная страница)
-   `/products` (Список всех продуктов)
-   `/products/:id` (Детальная страница продукта с использованием `useParams`)
-   `/admin` (Страница администратора, к которой можно перенаправить пользователя с главной страницы кнопкой, используя `useNavigate`).
-   404 страница для любых других URL.

Попробуйте использовать `NavLink` вместо `Link` для списка продуктов, чтобы автоматически применять активный класс к текущей ссылке.