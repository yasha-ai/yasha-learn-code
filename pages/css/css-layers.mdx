# CSS Layers (@layer): Контроль приоритета стилей


![Иллюстрация к уроку](/lessons/css-css-layers.png)
CSS Layers, или каскадные слои, позволяют более гибко контролировать приоритет CSS-правил. Это особенно полезно при работе с большими проектами, где важна предсказуемость и управляемость стилей.

## Что такое CSS Layers?

Представьте, что у вас есть несколько листов с CSS-правилами. Layers позволяют вам упорядочить эти листы, определяя, какие стили будут применяться в первую очередь, а какие будут переопределены. Это похоже на создание слоев в графическом редакторе, где слои, находящиеся выше, перекрывают слои, находящиеся ниже.

## Синтаксис @layer

Для создания слоя используется правило `@layer`. Можно объявить слои явно или использовать их в правилах `@import`.

**Пример 1: Явное объявление слоев**

```css
@layer base, components, utilities;

@layer base {
  body {
    font-family: sans-serif;
    margin: 0;
  }
}

@layer components {
  button {
    background-color: blue;
    color: white;
    padding: 10px 20px;
    border: none;
    cursor: pointer;
  }
}

@layer utilities {
  .margin-top-20 {
    margin-top: 20px;
  }
}
```

В этом примере мы объявили три слоя: `base`, `components` и `utilities`. Стили, определенные в слое `base`, будут применены первыми, затем `components`, а затем `utilities`.  Если в разных слоях есть правила, конфликтующие друг с другом, то правило из слоя, объявленного позже, будет иметь больший приоритет.

**Пример 2: Использование @import**

```css
@import url("reset.css") layer(base);
@import url("components.css") layer(components);
@import url("utilities.css") layer(utilities);

@layer base, components, utilities; /* Объявление слоев после импорта */
```

В этом примере мы импортируем CSS-файлы и назначаем их соответствующим слоям.  Важно помнить, что объявление слоев должно быть либо перед, либо после всех импортов с использованием `layer()`.

## Практические примеры кода

**Пример 3: Решение конфликтов стилей**

```html
<!DOCTYPE html>
<html>
<head>
  <title>CSS Layers Example</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <button class="primary-button margin-top-20">Кнопка</button>
</body>
</html>
```

```css
/* style.css */
@layer base, components, utilities;

@layer base {
  button {
    padding: 5px 10px;
  }
}

@layer components {
  .primary-button {
    background-color: green;
    color: white;
    border: none;
  }
}

@layer utilities {
  .margin-top-20 {
    margin-top: 20px;
  }
}
```

В этом примере, несмотря на то, что все стили применяются к одному и тому же элементу `<button>`, стили из слоя `utilities` и `components` переопределяют стили из слоя `base`.

## Жизненный пример

Многие современные CSS-фреймворки и библиотеки используют концепции, схожие с CSS Layers, для организации стилей. Например, Tailwind CSS использует систему "variants" и "utilities", которые можно рассматривать как слои, определяющие приоритет стилей.  Кроме того, в больших проектах, где используются сторонние библиотеки, CSS Layers помогают избежать конфликтов стилей, позволяя определить приоритет стилей вашего сайта над стилями библиотеки.  Это позволяет более гибко управлять внешним видом сайта и избежать неожиданных изменений стилей при обновлении библиотек.

## Ключевые моменты

*   `@layer` позволяет создавать слои для управления приоритетом CSS-правил.
*   Слои можно объявлять явно или использовать в правилах `@import`.
*   Порядок объявления слоев определяет их приоритет: последний объявленный слой имеет наибольший приоритет.
*   CSS Layers помогают избежать конфликтов стилей в больших проектах и при использовании сторонних библиотек.
*   Это мощный инструмент для организации и поддержки CSS-кода.



## Интерактивный пример

<Playground
  template="vanilla"
  files={{
    "/index.html": `<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CSS Layers Demo</title>
  <style>
    body { background-color: #282c34; color: white; font-family: sans-serif; }

    @layer base, theme;

    @layer theme {
      button { background-color: darkgreen; }
    }

    @layer base {
      button { background-color: blue; padding: 10px; border: none; color: white; cursor: pointer; }
    }

    button { margin: 10px; } /* Без слоя, самый приоритетный */

  </style>
</head>
<body>
  <button>Click me</button>
  <p>Кнопка должна быть синей (base), потом зелёной (theme), но в итоге станет стандартной из-за отсутствия слоя.</p>
</body>
</html>
`
  }}
/>
