## CSS: Стиль - Урок "@container: Container Queries"


![Иллюстрация к уроку](/lessons/css-container-queries.png)
Container Queries позволяют стилизовать элементы, основываясь на размере их *контейнера*, а не на размере всего окна браузера (как в случае с медиа-запросами). Это делает стили более гибкими и пригодными для повторного использования компонентов.

### Концепция Container Queries

Представьте, что у вас есть карточка товара, которую вы хотите отображать по-разному в зависимости от того, где она находится: в узкой боковой панели или в широком разделе контента. Вместо того, чтобы использовать медиа-запросы, ориентированные на размер экрана, вы можете использовать Container Queries, ориентированные на размер контейнера этой карточки.

Для этого нужно сначала объявить элемент-контейнер. Это делается с помощью свойства `container-type`.

```css
.container {
  container-type: inline-size; /* Контейнер, размер которого зависит от ширины */
}
```

Теперь, когда у нас есть контейнер, мы можем использовать `@container` для применения стилей к его потомкам, основываясь на размере этого контейнера.

```css
.item {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); /* По умолчанию */
}

@container (min-width: 300px) {
  .item {
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); /* Когда контейнер >= 300px */
  }
}
```

### Практические примеры кода

**HTML:**

```html
<div class="container">
  <div class="item">
    <h3>Название товара</h3>
    <p>Описание товара.</p>
    <button>Купить</button>
  </div>
</div>
```

**CSS:**

```css
.container {
  container-type: inline-size;
  border: 1px solid black;
  padding: 10px;
}

.item {
  background-color: #f0f0f0;
  padding: 10px;
  text-align: center;
}

h3 {
  font-size: 16px;
}

p {
  font-size: 14px;
}

@container (min-width: 400px) {
  h3 {
    font-size: 20px; /* Увеличиваем размер заголовка, если контейнер достаточно широк */
  }

  p {
    font-size: 16px; /* Увеличиваем размер параграфа, если контейнер достаточно широк */
  }
}
```

В этом примере, когда ширина `.container` становится 400px или больше, размер шрифта заголовка и параграфа внутри `.item` увеличивается.

### Жизненный пример

Container Queries особенно полезны при создании дизайн-систем и библиотек компонентов. Например, представим, что вы создаете библиотеку UI-компонентов. Компонент "карточка" может быть использован в разных частях сайта: в сайдбаре, в основной секции контента, в галерее. Container Queries позволяют этой карточке адаптироваться к доступному пространству, не требуя написания отдельных стилей для каждого случая использования.  Многие современные UI-фреймворки (хотя пока и не все) начинают внедрять поддержку Container Queries, чтобы упростить создание адаптивных и переиспользуемых компонентов.

### Ключевые моменты

*   `container-type: inline-size;` объявляет элемент как контейнер, размер которого зависит от ширины.
*   `@container` позволяет применять стили к потомкам контейнера, основываясь на его размере.
*   Container Queries упрощают создание адаптивных и переиспользуемых компонентов.
*   Они позволяют стилизовать элементы на основе размера их контейнера, а не размера окна браузера.
*   Container Queries полезны при создании дизайн-систем и библиотек компонентов.



## Интерактивный пример

<Sandpack
  template="vanilla"
  files={{
    "/index.html": `<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Container Queries Demo</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <div class="container">
    <div class="item">
      <h3>Название товара</h3>
      <p>Описание товара. Это описание может быть длинным или коротким, чтобы продемонстрировать адаптивность.</p>
      <button id="buyButton">Купить</button>
      <input type="text" id="quantity" value="1">
    </div>
  </div>

  <div class="controls">
    <label for="containerWidth">Ширина контейнера:</label>
    <input type="range" id="containerWidth" min="200" max="600" value="400">
    <span id="widthValue">400px</span>
  </div>

  <script src="/index.js"><\/script>
</body>
</html>`,
    "/styles.css": `body {
  font-family: sans-serif;
  background-color: #222;
  color: #eee;
  padding: 20px;
}

.container {
  container-type: inline-size;
  border: 1px solid #555;
  padding: 10px;
  margin-bottom: 20px;
  width: 400px; /* Начальная ширина */
}

.item {
  background-color: #333;
  padding: 20px;
  text-align: center;
  border-radius: 5px;
}

h3 {
  font-size: 16px;
  margin-bottom: 10px;
}

p {
  font-size: 14px;
  line-height: 1.4;
}

button {
  background-color: #4CAF50;
  color: white;
  padding: 10px 15px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 14px;
}

input[type="text"] {
  padding: 8px;
  border: 1px solid #777;
  border-radius: 4px;
  width: 50px;
  text-align: center;
  background-color: #444;
  color: #eee;
}

.controls {
  display: flex;
  align-items: center;
  gap: 10px;
}

label {
  font-size: 14px;
}

input[type="range"] {
  width: 200px;
}

/* Container Query стили */
@container (min-width: 400px) {
  h3 {
    font-size: 20px; /* Увеличиваем размер заголовка, если контейнер достаточно широк */
  }

  p {
    font-size: 16px; /* Увеличиваем размер параграфа, если контейнер достаточно широк */
  }

  button {
    font-size: 16px;
    padding: 12px 20px;
  }
}

@container (min-width: 500px) {
  .item {
    background-color: #555;
  }
}
`,
    "/index.js": `// Получаем элементы управления
const container = document.querySelector('.container');
const containerWidthInput = document.getElementById('containerWidth');
const widthValue = document.getElementById('widthValue');
const buyButton = document.getElementById('buyButton');
const quantityInput = document.getElementById('quantity');

// Функция для обновления ширины контейнера
function updateContainerWidth() {
  const width = containerWidthInput.value;
  container.style.width = width + 'px';
  widthValue.textContent = width + 'px';
}

// Обработчик изменения ширины контейнера
containerWidthInput.addEventListener('input', updateContainerWidth);

// Пример обработки нажатия кнопки "Купить"
buyButton.addEventListener('click', () => {
  const quantity = quantityInput.value;
  alert(\`Вы добавили \${'}quantity\${'} товаров в корзину!\`);
});

// Инициализация ширины контейнера
updateContainerWidth();
`
  }}
  options={{
    showNavigator: false,
    showLineNumbers: true,
    editorHeight: 400
  }}
/>
