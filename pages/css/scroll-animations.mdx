## CSS: Scroll-driven animations


![Иллюстрация к уроку](/lessons/css-scroll-animations.png)
Scroll-driven animations позволяют создавать интерактивные анимации, которые реагируют на прокрутку страницы. Это отличный способ сделать ваш сайт более привлекательным и вовлекающим, добавляя динамичные элементы, которые изменяются по мере прокрутки пользователем контента.

### Что такое Scroll-driven animations?

Вместо того чтобы запускать анимацию по таймеру или при наступлении определенного события (например, наведении мыши), scroll-driven animations привязывают прогресс анимации к положению полосы прокрутки.  Другими словами, анимация "проигрывается" по мере того, как пользователь прокручивает страницу.

### Основы Scroll-driven animations

Для создания scroll-driven animations нам потребуются новые CSS свойства, которые позволяют связать анимации с scroll контейнером.  Основные свойства:

*   `scroll-timeline`: Определяет, какой контейнер прокрутки будет контролировать анимацию.
*   `animation-timeline`: Связывает анимацию с определенной scroll-timeline.
*   `view-timeline`: Запускает анимацию, когда элемент входит в область видимости.
*   `view-timeline-name`: Имя области видимости для связывания с анимацией.

Рассмотрим простой пример:

```html
<!DOCTYPE html>
<html>
<head>
  <title>Scroll-Driven Animation</title>
  <style>
    body {
      height: 200vh; /* Увеличиваем высоту body для создания скролла */
    }

    .animated-box {
      width: 100px;
      height: 100px;
      background-color: red;
      animation: move 5s linear forwards;
      animation-timeline: view(); /* Связываем анимацию с прокруткой viewport */
      animation-range: entry 25% cover 75%; /* Анимация стартует когда элемент входит в область видимости на 25% и заканчивается, когда он покрыт на 75% */
    }

    @keyframes move {
      0% {
        transform: translateX(0);
      }
      100% {
        transform: translateX(500px);
      }
    }
  </style>
</head>
<body>
  <div class="animated-box"></div>
</body>
</html>
```

В этом примере:

*   `body` имеет высоту 200vh, чтобы создать возможность прокрутки.
*   `.animated-box`  - это элемент, который будет анимироваться.
*   `animation-timeline: view();` связывает анимацию `move` с областью видимости viewport.
*   `animation-range: entry 25% cover 75%;` задает диапазон прокрутки, в котором будет проигрываться анимация.  `entry 25%` означает, что анимация начинается, когда элемент входит в область видимости на 25%. `cover 75%` означает, что анимация заканчивается, когда элемент покрыт на 75%.

### Жизненный пример

Scroll-driven animations широко используются для создания параллакс-эффектов на сайтах, а также для анимирования элементов при их появлении в поле зрения пользователя. Многие современные веб-сайты и приложения используют эту технику для улучшения пользовательского опыта. Примеры:

*   **Сайты-портфолио:** Анимация фотографий, текста и других элементов при прокрутке страницы.
*   **Одностраничные сайты:** Плавный переход между секциями при прокрутке.
*   **Статьи и блоги:**  Анимация изображений и графиков по мере прочтения статьи.

Фреймворки, такие как GSAP (GreenSock Animation Platform), также предоставляют инструменты для создания scroll-driven animations, упрощая процесс и добавляя больше возможностей.

### Ключевые моменты

*   Scroll-driven animations связывают анимации с прокруткой страницы.
*   Используйте `scroll-timeline` и `animation-timeline` для контроля анимации.
*   `view-timeline` и `view-timeline-name` запускают анимации при входе элемента в область видимости.
*   `animation-range` определяет диапазон прокрутки, в котором будет проигрываться анимация.
*   Scroll-driven animations улучшают пользовательский опыт и делают сайты более интерактивными.



## Интерактивный пример

<Sandpack
  template="vanilla"
  files={{
    "/index.html": `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scroll-Driven Animation</title>
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <div class="container">
        <h1>Scroll-Driven Animation</h1>
        <p>Прокрутите страницу вниз, чтобы увидеть анимацию.</p>

        <div class="animated-box">
            <p id="box-text">Анимированный блок</p>
        </div>

        <div class="settings">
            <label for="animation-range-start">Начало анимации:</label>
            <input type="range" id="animation-range-start" min="0" max="100" value="25">
            <span id="animation-range-start-value">25%</span>

            <label for="animation-range-end">Конец анимации:</label>
            <input type="range" id="animation-range-end" min="0" max="100" value="75">
            <span id="animation-range-end-value">75%</span>
        </div>

        <div class="content">
            <p>Дополнительный контент для создания прокрутки...</p>
            <p>Дополнительный контент для создания прокрутки...</p>
            <p>Дополнительный контент для создания прокрутки...</p>
            <p>Дополнительный контент для создания прокрутки...</p>
            <p>Дополнительный контент для создания прокрутки...</p>
            <p>Дополнительный контент для создания прокрутки...</p>
            <p>Дополнительный контент для создания прокрутки...</p>
            <p>Дополнительный контент для создания прокрутки...</p>
            <p>Дополнительный контент для создания прокрутки...</p>
            <p>Дополнительный контент для создания прокрутки...</p>
            <p>Дополнительный контент для создания прокрутки...</p>
            <p>Дополнительный контент для создания прокрутки...</p>
            <p>Дополнительный контент для создания прокрутки...</p>
            <p>Дополнительный контент для создания прокрутки...</p>
            <p>Дополнительный контент для создания прокрутки...</p>
            <p>Дополнительный контент для создания прокрутки...</p>
            <p>Дополнительный контент для создания прокрутки...</p>
            <p>Дополнительный контент для создания прокрутки...</p>
            <p>Дополнительный контент для создания прокрутки...</p>
            <p>Дополнительный контент для создания прокрутки...</p>
        </div>
    </div>

    <script src="/index.js"></script>
</body>
</html>`,
    "/styles.css": `body {
    height: 200vh; /* Увеличиваем высоту body для создания скролла */
    margin: 0;
    font-family: sans-serif;
    background-color: #222;
    color: #eee;
    padding: 20px;
}

.container {
    max-width: 800px;
    margin: 0 auto;
}

h1 {
    text-align: center;
    margin-bottom: 30px;
}

.animated-box {
    width: 100px;
    height: 100px;
    background-color: #e44d26;
    color: white;
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: bold;
    position: relative; /* Важно для позиционирования */
    animation: move 5s linear forwards;
    animation-timeline: view(); /* Связываем анимацию с прокруткой viewport */
    animation-range: entry 25% cover 75%; /* Анимация стартует когда элемент входит в область видимости на 25% и заканчивается, когда он покрыт на 75% */
    margin-bottom: 50px;
}

@keyframes move {
    0% {
        transform: translateX(0);
        background-color: #e44d26;
    }
    50% {
        background-color: #f1c40f; /* Изменяем цвет в середине анимации */
    }
    100% {
        transform: translateX(calc(100vw - 140px)); /* Перемещаем до конца viewport */
        background-color: #2ecc71;
    }
}

.settings {
    margin-bottom: 20px;
    display: flex;
    flex-direction: column;
}

.settings label {
    margin-bottom: 5px;
}

.settings input[type="range"] {
    width: 100%;
}

.content {
    margin-top: 50px;
}

.content p {
    line-height: 1.6;
    margin-bottom: 15px;
}`,
    "/index.js": `// Получаем элементы управления
const animationRangeStart = document.getElementById('animation-range-start');
const animationRangeEnd = document.getElementById('animation-range-end');
const animationRangeStartValue = document.getElementById('animation-range-start-value');
const animationRangeEndValue = document.getElementById('animation-range-end-value');
const animatedBox = document.querySelector('.animated-box');

// Функция для обновления animation-range
function updateAnimationRange() {
    const startValue = animationRangeStart.value;
    const endValue = animationRangeEnd.value;

    animationRangeStartValue.textContent = startValue + '%';
    animationRangeEndValue.textContent = endValue + '%';

    // Обновляем CSS переменную для animation-range
    animatedBox.style.animationRange = \`entry \${'}startValue\${'}\% cover \${'}endValue\${'}\%\`;
}

// Добавляем слушатели событий для изменения диапазонов
animationRangeStart.addEventListener('input', updateAnimationRange);
animationRangeEnd.addEventListener('input', updateAnimationRange);

// Инициализируем значения при загрузке страницы
updateAnimationRange();`
  }}
  options={{
    showNavigator: false,
    showLineNumbers: true,
    editorHeight: 400
  }}
/>
