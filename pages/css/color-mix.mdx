## CSS: color-mix() и относительные цвета


![Иллюстрация к уроку](/lessons/css-color-mix.png)
В этом уроке мы познакомимся с мощным инструментом CSS – функцией `color-mix()` и концепцией относительных цветов. Они позволяют создавать сложные цветовые схемы и динамически изменять цвета на основе других, что значительно расширяет возможности стилизации веб-страниц.

### Что такое `color-mix()`?

Функция `color-mix()` позволяет смешивать два цвета в определенной пропорции. Это как смешивать краски в реальной жизни, но в мире CSS.  Синтаксис выглядит следующим образом:

```css
color-mix(in <пространство>, <цвет1> <процент1>, <цвет2> <процент2>);
```

*   `in <пространство>`: Определяет цветовое пространство, в котором будет происходить смешивание (например, `srgb`, `hsl`, `lab`). Если не указано, используется `srgb`.
*   `<цвет1>` и `<цвет2>`: Цвета, которые нужно смешать.
*   `<процент1>` и `<процент2>`: Процентное соотношение каждого цвета в смеси. Если сумма процентов меньше 100%, остаток берется из прозрачного черного (`transparent black`).

Пример:

```css
.example {
  background-color: color-mix(in srgb, red 50%, blue 50%); /* Получится фиолетовый */
}
```

В этом примере мы смешиваем красный и синий цвета в равных пропорциях, получая фиолетовый.

```css
.example2 {
  background-color: color-mix(in hsl, red 70%, blue 30%); /* Смешивание в цветовом пространстве hsl */
}
```

Здесь смешивание происходит в цветовом пространстве `hsl`, что может дать другой результат, чем в `srgb`.

### Относительные цвета

Относительные цвета позволяют создавать новые цвета на основе существующих, изменяя их компоненты (оттенок, насыщенность, яркость и т.д.).  Для этого используется ключевое слово `from` внутри функции `color()`.

Синтаксис:

```css
color(from <исходный-цвет> r g b [/ a]);
```

*   `<исходный-цвет>`:  Цвет, на основе которого будет создан новый.
*   `r`, `g`, `b`, `a`: Значения компонентов красного, зеленого, синего и альфа-канала соответственно.  Можно использовать ключевое слово `current` для сохранения исходного значения.

Пример:

```css
.original {
  --base-color: hsl(240, 100%, 50%); /* Синий цвет */
  background-color: var(--base-color);
}

.modified {
  --base-color: hsl(240, 100%, 50%);
  background-color: color(from var(--base-color) h calc(hue(var(--base-color)) + 30) s l); /* Сдвиг оттенка на 30 градусов */
}
```

В этом примере мы берем синий цвет и сдвигаем его оттенок на 30 градусов, получая цвет ближе к бирюзовому.  `hue(var(--base-color))` возвращает значение оттенка исходного цвета.  `s` и `l` оставляем без изменений (насыщенность и яркость).

### Практические примеры

Создание градиента на основе одного цвета:

```css
.gradient {
  --base-color: #3498db; /* Голубой цвет */
  background: linear-gradient(to right, var(--base-color), color(from var(--base-color) l calc(lightness(var(--base-color)) * 0.5))); /* Уменьшаем яркость второго цвета */
}
```

Подсветка элемента при наведении:

```css
.button {
  --base-color: #2ecc71; /* Зеленый цвет */
  background-color: var(--base-color);
  color: white;
}

.button:hover {
  background-color: color(from var(--base-color) l calc(lightness(var(--base-color)) * 1.2)); /* Увеличиваем яркость при наведении */
}
```

### Жизненный пример

Многие современные UI-библиотеки и фреймворки (например, Tailwind CSS, Chakra UI) используют относительные цвета и `color-mix()` (или их полифиллы) для создания цветовых схем, которые легко настраиваются и адаптируются.  Например, можно определить базовый цвет бренда и автоматически генерировать различные оттенки и варианты этого цвета для разных элементов интерфейса.  Это позволяет поддерживать консистентность дизайна и упрощает процесс стилизации.  Также, они полезны для создания темной/светлой темы, где можно автоматически пересчитывать цвета, чтобы они хорошо выглядели в разных условиях освещения.

### Ключевые моменты

*   `color-mix()` позволяет смешивать два цвета в заданных пропорциях.
*   Относительные цвета позволяют создавать новые цвета на основе существующих, изменяя их компоненты.
*   `color()` и ключевое слово `from` используются для работы с относительными цветами.
*   Эти инструменты полезны для создания динамических и адаптивных цветовых схем.
*   Они упрощают поддержку консистентности дизайна и создание темных/светлых тем.



## Интерактивный пример

<Sandpack
  template="vanilla"
  files={{
    "/index.html": `<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>color-mix() и относительные цвета</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <div class="container">
    <h1>color-mix() и относительные цвета</h1>

    <h2>Пример color-mix()</h2>
    <div class="color-mix-example">
      <div class="color-box" id="color-mix-box"></div>
      <label for="red-percentage">Красный (%):</label>
      <input type="number" id="red-percentage" value="50" min="0" max="100">
      <label for="blue-percentage">Синий (%):</label>
      <input type="number" id="blue-percentage" value="50" min="0" max="100">
    </div>

    <h2>Пример относительных цветов</h2>
    <div class="relative-color-example">
      <div class="color-box original" id="original-color-box"></div>
      <div class="color-box modified" id="modified-color-box"></div>
      <label for="hue-shift">Сдвиг оттенка (градусы):</label>
      <input type="number" id="hue-shift" value="30" min="-360" max="360">
    </div>

    <h2>Градиент на основе одного цвета</h2>
    <div class="gradient-example">
      <div class="gradient" id="gradient-box"></div>
    </div>

    <h2>Подсветка при наведении</h2>
    <button class="button" id="hover-button">Наведи на меня</button>
  </div>

  <script src="/index.js"></script>
</body>
</html>
`,
    "/styles.css": `body {
  font-family: sans-serif;
  background-color: #222;
  color: #eee;
  padding: 20px;
}

.container {
  max-width: 800px;
  margin: 0 auto;
}

h1, h2 {
  color: #ddd;
}

.color-mix-example, .relative-color-example, .gradient-example {
  margin-bottom: 20px;
  padding: 10px;
  border: 1px solid #555;
  border-radius: 5px;
}

.color-box {
  width: 100px;
  height: 100px;
  margin-bottom: 10px;
  border: 1px solid #888;
}

.original {
  --base-color: hsl(240, 100%, 50%); /* Синий цвет */
  background-color: var(--base-color);
}

.modified {
  --base-color: hsl(240, 100%, 50%);
  background-color: color(from var(--base-color) h calc(hue(var(--base-color)) + 30) s l); /* Сдвиг оттенка на 30 градусов */
}

.gradient {
  --base-color: #3498db; /* Голубой цвет */
  height: 50px;
  background: linear-gradient(to right, var(--base-color), color(from var(--base-color) l calc(lightness(var(--base-color)) * 0.5))); /* Уменьшаем яркость второго цвета */
}

.button {
  --base-color: #2ecc71; /* Зеленый цвет */
  background-color: var(--base-color);
  color: white;
  padding: 10px 20px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

.button:hover {
  background-color: color(from var(--base-color) h s calc(lightness(var(--base-color)) + 10%)); /* Увеличиваем яркость при наведении */
}
`,
    "/index.js": `// color-mix() пример
const redPercentageInput = document.getElementById('red-percentage');
const bluePercentageInput = document.getElementById('blue-percentage');
const colorMixBox = document.getElementById('color-mix-box');

function updateColorMix() {
  const redPercentage = redPercentageInput.value;
  const bluePercentage = bluePercentageInput.value;
  colorMixBox.style.backgroundColor = \`color-mix(in srgb, red \${redPercentage}%, blue \${bluePercentage}%)\`;
}

redPercentageInput.addEventListener('input', updateColorMix);
bluePercentageInput.addEventListener('input', updateColorMix);

updateColorMix(); // Инициализация

// Относительные цвета пример
const hueShiftInput = document.getElementById('hue-shift');
const originalColorBox = document.getElementById('original-color-box');
const modifiedColorBox = document.getElementById('modified-color-box');

function updateRelativeColor() {
  const hueShift = hueShiftInput.value;
  const baseColor = 'hsl(240, 100%, 50%)'; // Синий цвет
  modifiedColorBox.style.backgroundColor = \`color(from \${baseColor} h calc(hue(\${baseColor}) + \${hueShift}) s l)\`;
}

hueShiftInput.addEventListener('input', updateRelativeColor);

updateRelativeColor(); // Инициализация

// Подсветка при наведении (пример с кнопкой)
const hoverButton = document.getElementById('hover-button');
`,
  }}
  options={{
    showNavigator: false,
    showLineNumbers: true,
    editorHeight: 400
  }}
/>
