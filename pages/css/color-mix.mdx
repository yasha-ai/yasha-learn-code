## CSS: color-mix() и относительные цвета

![Иллюстрация к уроку](/lessons/css-color-mix.png)

В этом уроке мы познакомимся с мощным инструментом CSS – функцией `color-mix()` и концепцией относительных цветов. Они позволяют создавать сложные цветовые схемы и динамически изменять цвета на основе других, что значительно расширяет возможности стилизации веб-страниц.

### Что такое `color-mix()`?

Функция `color-mix()` позволяет смешивать два цвета в определенной пропорции. Это как смешивать краски в реальной жизни, но в мире CSS.  Синтаксис выглядит следующим образом:

```css
color-mix(in <пространство>, <цвет1> <процент1>, <цвет2> <процент2>);
```

*   `in <пространство>`: Определяет цветовое пространство, в котором будет происходить смешивание (например, `srgb`, `hsl`, `lab`). Если не указано, используется `srgb`.
*   `<цвет1>` и `<цвет2>`: Цвета, которые нужно смешать.
*   `<процент1>` и `<процент2>`: Процентное соотношение каждого цвета в смеси. Если сумма процентов меньше 100%, остаток берется из прозрачного черного (`transparent black`).

Пример:

```css
.example {
  background-color: color-mix(in srgb, red 50%, blue 50%); /* Получится фиолетовый */
}
```

В этом примере мы смешиваем красный и синий цвета в равных пропорциях, получая фиолетовый.

```css
.example2 {
  background-color: color-mix(in hsl, red 70%, blue 30%); /* Смешивание в цветовом пространстве hsl */
}
```

Здесь смешивание происходит в цветовом пространстве `hsl`, что может дать другой результат, чем в `srgb`.

### Относительные цвета

Относительные цвета позволяют создавать новые цвета на основе существующих, изменяя их компоненты (оттенок, насыщенность, яркость и т.д.).  Для этого используется ключевое слово `from` внутри функции `color()`.

Синтаксис:

```css
color(from <исходный-цвет> r g b [/ a]);
```

*   `<исходный-цвет>`:  Цвет, на основе которого будет создан новый.
*   `r`, `g`, `b`, `a`: Значения компонентов красного, зеленого, синего и альфа-канала соответственно.  Можно использовать ключевое слово `current` для сохранения исходного значения.

Пример:

```css
.original {
  --base-color: hsl(240, 100%, 50%); /* Синий цвет */
  background-color: var(--base-color);
}

.modified {
  --base-color: hsl(240, 100%, 50%);
  background-color: color(from var(--base-color) h calc(hue(var(--base-color)) + 30) s l); /* Сдвиг оттенка на 30 градусов */
}
```

В этом примере мы берем синий цвет и сдвигаем его оттенок на 30 градусов, получая цвет ближе к бирюзовому.  `hue(var(--base-color))` возвращает значение оттенка исходного цвета.  `s` и `l` оставляем без изменений (насыщенность и яркость).

### Практические примеры

Создание градиента на основе одного цвета:

```css
.gradient {
  --base-color: #3498db; /* Голубой цвет */
  background: linear-gradient(to right, var(--base-color), color(from var(--base-color) l calc(lightness(var(--base-color)) * 0.5))); /* Уменьшаем яркость второго цвета */
}
```

Подсветка элемента при наведении:

```css
.button {
  --base-color: #2ecc71; /* Зеленый цвет */
  background-color: var(--base-color);
  color: white;
}

.button:hover {
  background-color: color(from var(--base-color) l calc(lightness(var(--base-color)) * 1.2)); /* Увеличиваем яркость при наведении */
}
```

### Жизненный пример

Многие современные UI-библиотеки и фреймворки (например, Tailwind CSS, Chakra UI) используют относительные цвета и `color-mix()` (или их полифиллы) для создания цветовых схем, которые легко настраиваются и адаптируются.  Например, можно определить базовый цвет бренда и автоматически генерировать различные оттенки и варианты этого цвета для разных элементов интерфейса.  Это позволяет поддерживать консистентность дизайна и упрощает процесс стилизации.  Также, они полезны для создания темной/светлой темы, где можно автоматически пересчитывать цвета, чтобы они хорошо выглядели в разных условиях освещения.

### Ключевые моменты

*   `color-mix()` позволяет смешивать два цвета в заданных пропорциях.
*   Относительные цвета позволяют создавать новые цвета на основе существующих, изменяя их компоненты.
*   `color()` и ключевое слово `from` используются для работы с относительными цветами.
*   Эти инструменты полезны для создания динамических и адаптивных цветовых схем.
*   Они упрощают поддержку консистентности дизайна и создание темных/светлых тем.

### Практика

Попробуйте примеры в интерактивном редакторе:

<Playground 
  html={`<div class="color-mixer">
  <h2>color-mix() в действии</h2>
  
  <div class="section">
    <h3>Смешивание в sRGB</h3>
    <div class="color-row">
      <div class="color-box red">red</div>
      <div class="color-box mix-25">25% blue</div>
      <div class="color-box mix-50">50% blue</div>
      <div class="color-box mix-75">75% blue</div>
      <div class="color-box blue">blue</div>
    </div>
  </div>

  <div class="section">
    <h3>Смешивание в HSL</h3>
    <div class="color-row">
      <div class="color-box yellow">yellow</div>
      <div class="color-box hsl-mix-33">33% cyan</div>
      <div class="color-box hsl-mix-50">50% cyan</div>
      <div class="color-box hsl-mix-66">66% cyan</div>
      <div class="color-box cyan">cyan</div>
    </div>
  </div>

  <div class="section">
    <h3>Практическое применение</h3>
    <button class="btn primary">Наведи на меня!</button>
  </div>
</div>`}
  css={`* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

.color-mixer {
  padding: 30px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  min-height: 500px;
}

h2 {
  text-align: center;
  color: white;
  margin-bottom: 30px;
  font-size: 28px;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
}

.section {
  background: white;
  padding: 25px;
  border-radius: 12px;
  margin-bottom: 25px;
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
}

h3 {
  color: #2c3e50;
  margin-bottom: 20px;
  font-size: 18px;
  font-weight: 600;
}

.color-row {
  display: grid;
  grid-template-columns: repeat(5, 1fr);
  gap: 12px;
}

.color-box {
  height: 80px;
  border-radius: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  color: white;
  text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
  transition: transform 0.3s ease;
  font-size: 14px;
}

.color-box:hover {
  transform: translateY(-5px);
}

/* sRGB mixing */
.red { background: red; }
.blue { background: blue; }
.mix-25 { background: color-mix(in srgb, red 75%, blue 25%); }
.mix-50 { background: color-mix(in srgb, red 50%, blue 50%); }
.mix-75 { background: color-mix(in srgb, red 25%, blue 75%); }

/* HSL mixing */
.yellow { background: yellow; color: #333; }
.cyan { background: cyan; color: #333; }
.hsl-mix-33 { background: color-mix(in hsl, yellow 67%, cyan 33%); color: #333; }
.hsl-mix-50 { background: color-mix(in hsl, yellow 50%, cyan 50%); color: #333; }
.hsl-mix-66 { background: color-mix(in hsl, yellow 33%, cyan 67%); color: #333; }

/* Practical button example */
.btn {
  padding: 15px 40px;
  font-size: 16px;
  font-weight: bold;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
}

.btn.primary {
  background: #3498db;
  color: white;
}

.btn.primary:hover {
  background: color-mix(in srgb, #3498db 70%, white 30%);
  transform: translateY(-3px);
  box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
}

@media (max-width: 600px) {
  .color-row {
    grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
  }
}`}
/>
