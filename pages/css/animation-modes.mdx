## CSS: `animation-fill-mode` и `animation-direction`


![Иллюстрация к уроку](/lessons/css-animation-modes.png)
В этом уроке мы рассмотрим свойства `animation-fill-mode` и `animation-direction`, которые позволяют контролировать поведение анимации до ее начала, после ее окончания и направление проигрывания. Они добавляют гибкости и позволяют создавать более сложные и интересные анимации.

### `animation-fill-mode`: Заполнение состояния анимации

Свойство `animation-fill-mode` определяет, какие стили применяются к элементу *до* начала анимации и *после* ее завершения.  Это особенно полезно, если вы хотите, чтобы элемент оставался в конечном состоянии анимации или возвращался в исходное состояние.

Возможные значения:

*   `none` (значение по умолчанию): Стили анимации не применяются ни до, ни после анимации. Элемент возвращается к своим исходным стилям.
*   `forwards`: Элемент сохраняет стили, определенные в *последнем* ключевом кадре (`100%`) после завершения анимации.
*   `backwards`: Элемент применяет стили, определенные в *первом* ключевом кадре (`0%`) до начала анимации.  Если `animation-delay` положительное, элемент будет отображаться в этом состоянии, пока не начнется анимация.
*   `both`:  Сочетает в себе поведение `forwards` и `backwards`. Элемент применяет стили из первого ключевого кадра до начала анимации и стили из последнего ключевого кадра после завершения анимации.

Пример:

```html
<!DOCTYPE html>
<html>
<head>
<title>animation-fill-mode Example</title>
<style>
.box {
  width: 100px;
  height: 100px;
  background-color: red;
  animation-name: move;
  animation-duration: 2s;
  animation-fill-mode: forwards; /* Сохраняет финальное состояние */
}

@keyframes move {
  from {
    margin-left: 0;
  }
  to {
    margin-left: 200px;
    background-color: blue;
  }
}
</style>
</head>
<body>
  <div class="box"></div>
</body>
</html>
```

В этом примере после завершения анимации красный квадрат переместится вправо и станет синим, и останется в этом состоянии.

### `animation-direction`: Направление анимации

Свойство `animation-direction` определяет, в каком направлении проигрывается анимация.

Возможные значения:

*   `normal` (значение по умолчанию): Анимация проигрывается от начала до конца.
*   `reverse`: Анимация проигрывается в обратном направлении, от конца к началу.
*   `alternate`: Анимация проигрывается вперед, затем назад, затем снова вперед, и так далее.
*   `alternate-reverse`: Анимация проигрывается назад, затем вперед, затем снова назад, и так далее.

Пример:

```html
<!DOCTYPE html>
<html>
<head>
<title>animation-direction Example</title>
<style>
.box {
  width: 100px;
  height: 100px;
  background-color: red;
  animation-name: move;
  animation-duration: 2s;
  animation-iteration-count: infinite; /* Бесконечное повторение */
  animation-direction: alternate; /* Чередование направления */
}

@keyframes move {
  from {
    margin-left: 0;
  }
  to {
    margin-left: 200px;
  }
}
</style>
</head>
<body>
  <div class="box"></div>
</body>
</html>
```

В этом примере красный квадрат будет двигаться вправо, затем влево, повторяясь бесконечно.

### Жизненный пример

`animation-fill-mode` часто используется для создания плавных переходов при наведении курсора на элементы.  Например, кнопка, меняющая цвет при наведении.  `animation-direction` широко используется в индикаторах загрузки, где элемент циклично двигается вперед и назад, показывая процесс загрузки.  В различных UI фреймворках (например, Material UI, Bootstrap) анимации с использованием этих свойств применяются для визуальной обратной связи при взаимодействии пользователя с элементами интерфейса.  Также, их можно встретить на сайтах-портфолио для создания интересных эффектов при прокрутке страницы.

### Ключевые моменты

*   `animation-fill-mode` управляет стилями до и после анимации.
*   `animation-direction` управляет направлением проигрывания анимации.
*   Комбинируя эти свойства, можно создавать сложные и интересные анимации.
*   `animation-fill-mode: forwards` часто используется, чтобы сохранить конечное состояние анимации.
*   `animation-direction: alternate` создает эффект "пинг-понга".



## Интерактивный пример

<Sandpack
  template="vanilla"
  files={{
    "/index.html": `<!DOCTYPE html>
<html>
<head>
  <title>animation-fill-mode & animation-direction</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <div class="container">
    <div class="box"></div>
    <div class="controls">
      <div>
        <label for="fillMode">animation-fill-mode:</label>
        <select id="fillMode">
          <option value="none">none</option>
          <option value="forwards">forwards</option>
          <option value="backwards">backwards</option>
          <option value="both">both</option>
        </select>
      </div>
      <div>
        <label for="direction">animation-direction:</label>
        <select id="direction">
          <option value="normal">normal</option>
          <option value="reverse">reverse</option>
          <option value="alternate">alternate</option>
          <option value="alternate-reverse">alternate-reverse</option>
        </select>
      </div>
      <div>
        <label for="duration">animation-duration (s):</label>
        <input type="number" id="duration" value="2" min="0.5" step="0.5">
      </div>
    </div>
  </div>
  <script src="/index.js"><\/script>
</body>
</html>`,
    "/styles.css": `body {
  font-family: sans-serif;
  background-color: #222;
  color: #eee;
  padding: 20px;
}

.container {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.box {
  width: 100px;
  height: 100px;
  background-color: red;
  animation-name: move;
  animation-duration: 2s;
  animation-iteration-count: infinite;
  margin-bottom: 20px;
}

@keyframes move {
  0% {
    margin-left: 0;
    background-color: red;
  }
  100% {
    margin-left: 200px;
    background-color: blue;
  }
}

.controls {
  display: flex;
  flex-direction: column;
  gap: 10px;
  margin-top: 20px;
}

.controls > div {
  display: flex;
  align-items: center;
  gap: 10px;
}

label {
  color: #ccc;
}

input, select {
  background-color: #444;
  color: #eee;
  border: none;
  padding: 5px;
  border-radius: 5px;
}
`,
    "/index.js": `const box = document.querySelector('.box');
const fillModeSelect = document.getElementById('fillMode');
const directionSelect = document.getElementById('direction');
const durationInput = document.getElementById('duration');

function updateAnimation() {
  // Получаем выбранные значения из элементов управления
  const fillMode = fillModeSelect.value;
  const direction = directionSelect.value;
  const duration = durationInput.value;

  // Обновляем стили элемента box
  box.style.animationFillMode = fillMode;
  box.style.animationDirection = direction;
  box.style.animationDuration = duration + 's';
}

// Добавляем слушатели событий для изменений в элементах управления
fillModeSelect.addEventListener('change', updateAnimation);
directionSelect.addEventListener('change', updateAnimation);
durationInput.addEventListener('input', updateAnimation);

// Вызываем функцию updateAnimation, чтобы установить начальные значения
updateAnimation();
`
  }}
  options={{
    showNavigator: false,
    showLineNumbers: true,
    editorHeight: 400
  }}
/>
