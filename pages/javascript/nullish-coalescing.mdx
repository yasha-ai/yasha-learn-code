# JavaScript: Мозги. Урок: Nullish coalescing ??


![Иллюстрация к уроку](/lessons/javascript-nullish-coalescing.png)
Привет! Сегодня мы разберем оператор `??` (nullish coalescing), который поможет нам элегантно обрабатывать значения, которые могут быть `null` или `undefined`. Он упрощает код и делает его более читаемым.

## Что такое Nullish Coalescing Operator (??)

Оператор `??` возвращает правый операнд, только если левый операнд равен `null` или `undefined`. В противном случае, он возвращает левый операнд. Думайте о нем как о безопасном способе предоставить значение по умолчанию, когда переменная "пустая".

### Пример кода

```javascript
let name = null;
let defaultName = "Guest";

let displayName = name ?? defaultName; // displayName будет "Guest"

console.log(displayName); // Выведет: Guest

name = "Alice";
displayName = name ?? defaultName; // displayName будет "Alice"

console.log(displayName); // Выведет: Alice
```

В этом примере, если `name` – `null` или `undefined`, то `displayName` получит значение `defaultName`. Если `name` содержит какое-либо другое значение, то `displayName` получит это значение.

## Практические примеры

Вот несколько примеров использования `??` в разных сценариях:

```javascript
// 1. Установка значения по умолчанию для переменной
let userAge = null;
let age = userAge ?? 18; // Если userAge null или undefined, age будет 18
console.log(age); // Выведет: 18

// 2. Работа с объектами
let user = {
  name: "Bob",
  // age: null // Предположим, что age отсутствует в объекте
};

let userAgeFromObject = user.age ?? 25; // Если user.age null или undefined, userAgeFromObject будет 25
console.log(userAgeFromObject); // Выведет: 25

// 3. Использование с функциями
function greet(name) {
  let greeting = "Hello, " + (name ?? "User") + "!";
  return greeting;
}

console.log(greet("Charlie")); // Выведет: Hello, Charlie!
console.log(greet(null)); // Выведет: Hello, User!
```

## Жизненный пример

В React и других фреймворках часто используются пропсы (props) для передачи данных компонентам.  Иногда пропсы могут быть не переданы, и в этом случае `??` может быть полезен для установки значений по умолчанию.

```javascript
// Пример компонента React
function Greeting(props) {
  const name = props.name ?? "Guest";
  return <h1>Hello, {name}!</h1>;
}

// Использование компонента
// <Greeting name="Eve" />  // Выведет: Hello, Eve!
// <Greeting />           // Выведет: Hello, Guest!
```

В Redux, Vuex и других системах управления состоянием, `??` может использоваться для безопасного доступа к данным, которые могут быть еще не загружены или иметь значение `null` или `undefined`.

## Ключевые моменты

*   `??` проверяет только `null` и `undefined`.
*   `??` отличается от `||` (логическое ИЛИ), который проверяет на любой "falsy" value (0, "", NaN, null, undefined, false).
*   `??` делает код более читаемым, когда нужно предоставить значение по умолчанию для `null` или `undefined`.
*   `??` широко используется в современных JavaScript-фреймворках и библиотеках.



## Интерактивный пример

<Sandpack
  template="vanilla"
  files={{
    "/index.html": `<!DOCTYPE html>
<html>
<head>
  <title>Nullish Coalescing Operator</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <h1>Nullish Coalescing Operator (??)</h1>

    <label for="nameInput">Введите имя:</label>
    <input type="text" id="nameInput" placeholder="Ваше имя">

    <p id="greeting">Привет, Гость!</p>

    <label for="ageInput">Введите возраст:</label>
    <input type="number" id="ageInput" placeholder="Ваш возраст">
    <p id="ageDisplay">Возраст: Не указан</p>

    <button id="updateButton">Обновить приветствие и возраст</button>
  </div>

  <script src="index.js"><\/script>
</body>
</html>`,
    "/styles.css": `body {
  font-family: sans-serif;
  background-color: #222;
  color: #eee;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  margin: 0;
}

.container {
  background-color: #333;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
  text-align: center;
  width: 80%;
  max-width: 500px;
}

h1 {
  color: #ddd;
}

label {
  display: block;
  margin-top: 10px;
  color: #aaa;
}

input[type="text"], input[type="number"] {
  width: 100%;
  padding: 8px;
  margin-top: 5px;
  margin-bottom: 10px;
  border: 1px solid #555;
  border-radius: 4px;
  background-color: #444;
  color: #eee;
}

button {
  background-color: #555;
  color: #eee;
  padding: 10px 15px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  transition: background-color 0.3s ease;
}

button:hover {
  background-color: #777;
}

p {
  margin-top: 10px;
  color: #ccc;
}`,
    "/index.js": `// Получаем элементы DOM
const nameInput = document.getElementById("nameInput");
const greeting = document.getElementById("greeting");
const ageInput = document.getElementById("ageInput");
const ageDisplay = document.getElementById("ageDisplay");
const updateButton = document.getElementById("updateButton");

// Функция для обновления приветствия
function updateGreeting() {
  const name = nameInput.value;
  const displayName = name ?? "Гость"; // Используем nullish coalescing operator
  greeting.textContent = \`Привет, \${displayName}!\`;
}

// Функция для обновления возраста
function updateAge() {
  const age = ageInput.value;
  const displayAge = age ?? "Не указан"; // Используем nullish coalescing operator
  ageDisplay.textContent = \`Возраст: \${displayAge}\`;
}

// Обработчик события для кнопки
updateButton.addEventListener("click", () => {
  updateGreeting();
  updateAge();
});

// Инициализация приветствия и возраста при загрузке страницы
updateGreeting();
updateAge();
`
  }}
  options={{
    showNavigator: false,
    showLineNumbers: true,
    editorHeight: 400
  }}
/>
