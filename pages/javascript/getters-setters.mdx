## JavaScript: Мозги. Урок 3: Геттеры и сеттеры


![Иллюстрация к уроку](/lessons/javascript-getters-setters.png)
Геттеры и сеттеры - это специальные методы в JavaScript, которые позволяют контролировать доступ к свойствам объекта. Они дают нам возможность выполнять дополнительную логику при чтении (геттер) и записи (сеттер) значений свойств.

### Что такое геттеры и сеттеры?

Представьте, что обычное свойство объекта - это просто ячейка памяти, где хранится значение. Геттеры и сеттеры - это "стражи" этой ячейки.

*   **Геттер (getter)** - метод, который вызывается, когда мы пытаемся получить значение свойства. Он позволяет нам вычислить или модифицировать значение перед тем, как вернуть его.
*   **Сеттер (setter)** - метод, который вызывается, когда мы пытаемся присвоить значение свойству. Он позволяет нам выполнить валидацию, преобразование или другие действия перед тем, как сохранить значение.

### Пример кода

```javascript
const person = {
  firstName: 'John',
  lastName: 'Doe',
  get fullName() { // Геттер для получения полного имени
    return `${this.firstName} ${this.lastName}`;
  },
  set fullName(name) { // Сеттер для установки полного имени
    const parts = name.split(' ');
    this.firstName = parts[0];
    this.lastName = parts[1];
  }
};

console.log(person.fullName); // Вывод: John Doe (вызывается геттер)

person.fullName = 'Jane Smith'; // Вызывается сеттер
console.log(person.firstName); // Вывод: Jane
console.log(person.lastName); // Вывод: Smith
```

В этом примере `fullName` - это не обычное свойство, а геттер и сеттер. Когда мы обращаемся к `person.fullName`, вызывается геттер, который формирует полное имя из `firstName` и `lastName`. Когда мы присваиваем значение `person.fullName`, вызывается сеттер, который разделяет строку на имя и фамилию и устанавливает их.

### Еще один пример с валидацией

```javascript
const circle = {
  radius: 1,
  get area() {
    return Math.PI * this.radius * this.radius;
  },
  set radius(value) {
    if (value <= 0) {
      console.error("Радиус должен быть положительным числом!");
      return;
    }
    this._radius = value; // Используем _radius, чтобы избежать бесконечной рекурсии
  },
  get radius() {
    return this._radius;
  }
};

circle.radius = 5;
console.log(circle.area); // Вывод: 78.53981633974483

circle.radius = -2; // Вывод ошибки в консоль
console.log(circle.radius); // Вывод: undefined (так как сеттер не позволил изменить radius)
```

Здесь сеттер `radius` проверяет, является ли новое значение положительным. Если нет, он выводит ошибку и не позволяет изменить радиус. Обратите внимание на использование `_radius` в сеттере и геттере для избежания бесконечной рекурсии.

### Жизненный пример

Геттеры и сеттеры широко используются во фреймворках и библиотеках, таких как React, Vue и Angular, для реализации реактивных свойств.  Когда значение реактивного свойства изменяется через сеттер, фреймворк автоматически обновляет DOM, чтобы отразить эти изменения.

Например, в Vue.js сеттеры используются для отслеживания изменений данных и автоматического обновления пользовательского интерфейса.  Также геттеры могут быть использованы для кэширования результатов сложных вычислений, чтобы не пересчитывать их каждый раз при обращении к свойству.

### Ключевые моменты

*   Геттеры и сеттеры позволяют контролировать доступ к свойствам объекта.
*   Геттеры вызываются при чтении значения свойства.
*   Сеттеры вызываются при присваивании значения свойству.
*   Они полезны для валидации данных, преобразования данных и реализации реактивных свойств.
*   Используйте соглашение об именовании (например, `_property`) для внутренних переменных, чтобы избежать бесконечной рекурсии при использовании геттеров и сеттеров.



## Интерактивный пример

<Sandpack
  template="vanilla"
  files={{
    "/index.html": `<!DOCTYPE html>
<html>
<head>
  <title>Геттеры и сеттеры</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div id="app">
    <h1>Геттеры и сеттеры</h1>
    <p>Полное имя: <span id="fullName"></span></p>
    <label for="firstName">Имя:</label>
    <input type="text" id="firstName" value="John"><br><br>
    <label for="lastName">Фамилия:</label>
    <input type="text" id="lastName" value="Doe"><br><br>
    <button id="updateButton">Обновить полное имя</button>

    <h2>Круг</h2>
    <p>Радиус: <input type="number" id="radiusInput" value="5"></p>
    <p>Площадь: <span id="area"></span></p>
  </div>
  <script src="index.js"><\/script>
</body>
</html>`,
    "/styles.css": `body {
  font-family: sans-serif;
  background-color: #222;
  color: #eee;
  padding: 20px;
}

#app {
  background-color: #333;
  padding: 20px;
  border-radius: 5px;
}

input[type="text"], input[type="number"] {
  background-color: #444;
  color: #eee;
  border: none;
  padding: 5px;
  border-radius: 3px;
  margin-bottom: 5px;
}

button {
  background-color: #555;
  color: #eee;
  border: none;
  padding: 10px 20px;
  border-radius: 5px;
  cursor: pointer;
}

button:hover {
  background-color: #777;
}`,
    "/index.js": `// Объект Person с геттерами и сеттерами
const person = {
  firstName: 'John',
  lastName: 'Doe',
  get fullName() {
    return \`\${this.firstName} \${this.lastName}\`;
  },
  set fullName(name) {
    const parts = name.split(' ');
    this.firstName = parts[0];
    this.lastName = parts[1];
  }
};

// Объект Circle с геттерами и сеттерами и валидацией
const circle = {
  _radius: 5, // Приватное свойство для хранения радиуса
  get radius() {
    return this._radius;
  },
  set radius(value) {
    if (value <= 0) {
      alert("Радиус должен быть положительным числом!");
      return;
    }
    this._radius = value;
    updateArea(); // Обновляем площадь при изменении радиуса
  },
  get area() {
    return Math.PI * this.radius * this.radius;
  }
};

// Получаем элементы DOM
const fullNameSpan = document.getElementById('fullName');
const firstNameInput = document.getElementById('firstName');
const lastNameInput = document.getElementById('lastName');
const updateButton = document.getElementById('updateButton');
const radiusInput = document.getElementById('radiusInput');
const areaSpan = document.getElementById('area');

// Функция для обновления полного имени в DOM
function updateFullName() {
  fullNameSpan.textContent = person.fullName;
}

// Функция для обновления площади круга в DOM
function updateArea() {
  areaSpan.textContent = circle.area.toFixed(2); // Ограничиваем до 2 знаков после запятой
}

// Обработчик события для кнопки "Обновить полное имя"
updateButton.addEventListener('click', () => {
  person.firstName = firstNameInput.value;
  person.lastName = lastNameInput.value;
  updateFullName();
});

// Обработчик события для изменения радиуса
radiusInput.addEventListener('change', () => {
  circle.radius = parseFloat(radiusInput.value); // Преобразуем в число с плавающей точкой
});

// Инициализация
updateFullName();
updateArea();
`
  }}
  options={{
    showNavigator: false,
    showLineNumbers: true,
    editorHeight: 400
  }}
/>
