import { Sandpack } from '@codesandbox/sandpack-react'

## JavaScript: –ú–æ–∑–≥–∏. –£—Ä–æ–∫: Service Workers

Service Workers - —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç JavaScript, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π —Å–¥–µ–ª–∞—Ç—å –≤–∞—à–∏ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±—ã—Å—Ç—Ä–µ–µ, –Ω–∞–¥–µ–∂–Ω–µ–µ –∏ —Å–ø–æ—Å–æ–±–Ω—ã–º–∏ —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –æ—Ñ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–µ. –ü–æ —Å—É—Ç–∏, —ç—Ç–æ —Å–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –≤–∞—à–µ–π –≤–µ–±-—Å—Ç—Ä–∞–Ω–∏—Ü—ã.

### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª Service Worker

```mermaid
stateDiagram-v2
    [*] --> Registration
    Registration --> Installing
    Installing --> Installed
    Installed --> Activating
    Activating --> Activated
    Activated --> Fetching: Intercept Requests
    Activated --> Idle
    Idle --> Terminated
    Terminated --> Activated: New Event
    
    Installing --> Error: Failed to install
    Error --> [*]
```
*–°—Ç–∞–¥–∏–∏ –∂–∏–∑–Ω–∏ Service Worker: –æ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –¥–æ –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –∑–∞–ø—Ä–æ—Å–æ–≤.*

### –ß—Ç–æ —Ç–∞–∫–æ–µ Service Worker?

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ Service Worker –∫–∞–∫ –ø–æ—Å—Ä–µ–¥–Ω–∏–∫–∞ –º–µ–∂–¥—É –≤–∞—à–∏–º –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º, –±—Ä–∞—É–∑–µ—Ä–æ–º –∏ —Å–µ—Ç—å—é. –û–Ω –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã, —É–ø—Ä–∞–≤–ª—è–µ—Ç –∫–µ—à–µ–º –∏ –º–æ–∂–µ—Ç –¥–∞–∂–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.  –û–Ω —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ, –ø–æ—ç—Ç–æ–º—É –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫ –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –ø–ª–∞–≤–Ω—É—é —Ä–∞–±–æ—Ç—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞.

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Service Worker

–ü—Ä–µ–∂–¥–µ —á–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Service Worker, –µ–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç—Å—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–∫—Ä–∏–ø—Ç–µ –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

```javascript
// index.js
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('/sw.js') // –ü—É—Ç—å –∫ –≤–∞—à–µ–º—É service worker —Ñ–∞–π–ª—É
    .then(registration => {
      console.log('Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ:', registration);
    })
    .catch(error => {
      console.log('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ Service Worker:', error);
    });
}
```

–≠—Ç–æ—Ç –∫–æ–¥ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ª–∏ –±—Ä–∞—É–∑–µ—Ä Service Workers, –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç `/sw.js`.

### sw.js: –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª Service Worker

–§–∞–π–ª `sw.js` —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–æ–≥–∏–∫—É –≤–∞—à–µ–≥–æ Service Worker.  –û—Å–Ω–æ–≤–Ω—ã–µ —ç—Ç–∞–ø—ã –∂–∏–∑–Ω–µ–Ω–Ω–æ–≥–æ —Ü–∏–∫–ª–∞:

1.  **Install:**  –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –ø–µ—Ä–≤–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–µ Service Worker.  –ó–¥–µ—Å—å –æ–±—ã—á–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤.

```javascript
// sw.js
const CACHE_NAME = 'my-site-cache-v1';
const urlsToCache = [
  '/',
  '/index.html',
  '/styles.css',
  '/script.js'
];

self.addEventListener('install', function(event) {
  // –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ Service Worker
  event.waitUntil(
    caches.open(CACHE_NAME)
      .then(function(cache) {
        console.log('–û—Ç–∫—Ä—ã—Ç –∫–µ—à:', CACHE_NAME);
        return cache.addAll(urlsToCache); // –ö–µ—à–∏—Ä—É–µ–º —Ä–µ—Å—É—Ä—Å—ã
      })
  );
});
```

2.  **Activate:** –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏.  –ó–¥–µ—Å—å —á–∞—Å—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä–æ–≥–æ –∫–µ—à–∞.

```javascript
self.addEventListener('activate', function(event) {
  // –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ Service Worker
  event.waitUntil(
    caches.keys().then(function(cacheNames) {
      return Promise.all(
        cacheNames.map(function(cacheName) {
          if (cacheName !== CACHE_NAME) {
            console.log('–£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π –∫–µ—à:', cacheName);
            return caches.delete(cacheName); // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–π –∫–µ—à
          }
        })
      );
    })
  );
});
```

3.  **Fetch:** –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã.  –ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –≤–µ—Ä–Ω—É—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –∫–µ—à–∞ –∏–ª–∏ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –∏—Ö –∏–∑ —Å–µ—Ç–∏.

```javascript
self.addEventListener('fetch', function(event) {
  // –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ–º —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã
  event.respondWith(
    caches.match(event.request) // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –∑–∞–ø—Ä–æ—Å –≤ –∫–µ—à–µ
      .then(function(response) {
        // –ï—Å–ª–∏ –µ—Å—Ç—å –≤ –∫–µ—à–µ, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –µ–≥–æ
        if (response) {
          return response;
        }

        // –ï—Å–ª–∏ –Ω–µ—Ç –≤ –∫–µ—à–µ, –¥–µ–ª–∞–µ–º –∑–∞–ø—Ä–æ—Å –≤ —Å–µ—Ç—å
        return fetch(event.request).then(
          function(response) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –æ—Ç–≤–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π
            if(!response || response.status !== 200 || response.type !== 'basic') {
              return response;
            }

            // –ö–ª–æ–Ω–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç (–ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑)
            var responseToCache = response.clone();

            caches.open(CACHE_NAME)
              .then(function(cache) {
                cache.put(event.request, responseToCache); // –ö–µ—à–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç
              });

            return response;
          }
        );
      })
    );
});
```

### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä

–ú–Ω–æ–≥–∏–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ —Å–∞–π—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç Service Workers –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –æ—Ñ—Ñ–ª–∞–π–Ω-–¥–æ—Å—Ç—É–ø–∞.  –ù–∞–ø—Ä–∏–º–µ—Ä:

*   **Progressive Web Apps (PWAs):** Service Workers —è–≤–ª—è—é—Ç—Å—è –∫–ª—é—á–µ–≤–æ–π —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–µ–π –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è PWAs, –ø–æ–∑–≤–æ–ª—è—è –∏–º —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –Ω–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
*   **Google Maps:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Service Workers –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –∫–∞—Ä—Ç, –ø–æ–∑–≤–æ–ª—è—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫–∞—Ä—Ç—ã –¥–∞–∂–µ –±–µ–∑ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.
*   **–ù–æ–≤–æ—Å—Ç–Ω—ã–µ —Å–∞–π—Ç—ã:** –ú–æ–≥—É—Ç –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—å–∏ –¥–ª—è —á—Ç–µ–Ω–∏—è –≤ –æ—Ñ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–µ.
*   **–§—Ä–µ–π–º–≤–æ—Ä–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, React, Angular, Vue):**  –ò–º–µ—é—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏–ª–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Service Workers.  –ù–∞–ø—Ä–∏–º–µ—Ä, `create-react-app` —á–∞—Å—Ç–æ —Å–æ–¥–µ—Ä–∂–∏—Ç `service-worker.js` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.

### –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã

*   Service Workers —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ.
*   –û–Ω–∏ –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø –∫ Cache API –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤.
*   –û–Ω–∏ –º–æ–≥—É—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —Å–µ—Ç–µ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã.
*   –û–Ω–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Ä–∞–±–æ—Ç–∞—é—â–∏–µ –≤ –æ—Ñ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–µ.
*   –í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª Service Worker (install, activate, fetch).
*   –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ Service Worker –≤–∞–∂–Ω–æ –æ—á–∏—â–∞—Ç—å —Å—Ç–∞—Ä—ã–π –∫–µ—à.

### –ü—Ä–∞–∫—Ç–∏–∫–∞

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ:

<Sandpack template="vanilla">

```js
const app = document.querySelector('#app');

app.innerHTML = `
  <h2>‚öôÔ∏è Service Worker API Demo</h2>
  
  <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 12px; margin: 20px 0;">
    <h3 style="margin: 0 0 10px 0;">üéØ –°—Ç–∞—Ç—É—Å Service Worker</h3>
    <div id="swStatus" style="
      background: rgba(255,255,255,0.2);
      padding: 15px;
      border-radius: 8px;
      font-family: monospace;
      font-size: 14px;
    ">
      –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏...
    </div>
  </div>
  
  <div style="display: grid; gap: 10px; margin: 20px 0;">
    <button id="checkSupport" class="demo-btn">
      ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É Service Worker
    </button>
    <button id="showLifecycle" class="demo-btn">
      üîÑ –ü–æ–∫–∞–∑–∞—Ç—å –∂–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª
    </button>
    <button id="showCaching" class="demo-btn">
      üíæ –ü—Ä–∏–º–µ—Ä –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
    </button>
    <button id="showFetch" class="demo-btn">
      üåê –ü–µ—Ä–µ—Ö–≤–∞—Ç fetch-–∑–∞–ø—Ä–æ—Å–æ–≤
    </button>
    <button id="showPWA" class="demo-btn">
      üì± –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ PWA
    </button>
    <button id="showCode" class="demo-btn">
      üíª –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∫–æ–¥–∞
    </button>
  </div>
  
  <div id="output" style="
    background: #f5f5f5; 
    padding: 20px; 
    border-radius: 8px; 
    font-family: monospace; 
    font-size: 13px; 
    min-height: 300px;
    line-height: 1.6;
  "></div>
  
  <div style="background: #fff3e0; padding: 15px; border-radius: 8px; border-left: 4px solid #FF9800; margin-top: 20px;">
    <h4 style="margin: 0 0 10px 0;">‚ö†Ô∏è –í–∞–∂–Ω–æ –∑–Ω–∞—Ç—å!</h4>
    <ul style="margin: 0; padding-left: 20px; font-size: 14px; line-height: 1.8;">
      <li>Service Workers —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –ø–æ <strong>HTTPS</strong> (–∫—Ä–æ–º–µ localhost)</li>
      <li>–†–∞–±–æ—Ç–∞—é—Ç –≤ <strong>–æ—Ç–¥–µ–ª—å–Ω–æ–º –ø–æ—Ç–æ–∫–µ</strong>, –Ω–µ –±–ª–æ–∫–∏—Ä—É—è UI</li>
      <li>–ù–µ –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ DOM –Ω–∞–ø—Ä—è–º—É—é</li>
      <li>–ú–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –¥–∞–∂–µ –∫–æ–≥–¥–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–∫—Ä—ã—Ç–∞</li>
      <li>–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ SW —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–ª–∏ skipWaiting()</li>
    </ul>
  </div>
`;

const output = document.querySelector('#output');
const swStatus = document.querySelector('#swStatus');

function log(message, color = '#333') {
  output.innerHTML += \`<div style="color: \${color}; margin: 5px 0;">\${message}</div>\`;
  console.log(message);
}

function clearOutput() {
  output.innerHTML = '';
}

function highlightCode(code) {
  return \`<pre style="background: #282c34; color: #abb2bf; padding: 15px; border-radius: 6px; overflow-x: auto; margin: 10px 0;"><code>\${code}</code></pre>\`;
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
function checkSupport() {
  if ('serviceWorker' in navigator) {
    swStatus.innerHTML = \`
      ‚úÖ <strong>Service Worker –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è!</strong><br>
      <span style="font-size: 12px; opacity: 0.9;">–ë—Ä–∞—É–∑–µ—Ä: \${navigator.userAgent.split(' ').slice(-2).join(' ')}</span>
    \`;
    return true;
  } else {
    swStatus.innerHTML = \`
      ‚ùå <strong>Service Worker –ù–ï –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è</strong><br>
      <span style="font-size: 12px; opacity: 0.9;">–û–±–Ω–æ–≤–∏—Ç–µ –±—Ä–∞—É–∑–µ—Ä –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–π –≤–µ—Ä—Å–∏–∏</span>
    \`;
    return false;
  }
}

const demos = {
  checkSupport: () => {
    clearOutput();
    log('üîç <strong>–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ Service Worker</strong>', '#2196F3');
    log('');
    
    const supported = checkSupport();
    
    log(\`–†–µ–∑—É–ª—å—Ç–∞—Ç: \${supported ? '‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è' : '‚ùå –ù–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è'}\`, supported ? '#4CAF50' : '#f44336');
    log('');
    
    if (supported) {
      log('–ü—Ä–æ–≤–µ—Ä–∫–∞ API:', '#666');
      log(\`  ‚Ä¢ navigator.serviceWorker: \${typeof navigator.serviceWorker}\`, '#4CAF50');
      log(\`  ‚Ä¢ Cache API: \${'caches' in window ? '‚úÖ' : '‚ùå'}\`, 'caches' in window ? '#4CAF50' : '#f44336');
      log(\`  ‚Ä¢ Push API: \${'PushManager' in window ? '‚úÖ' : '‚ùå'}\`, 'PushManager' in window ? '#4CAF50' : '#f44336');
      log(\`  ‚Ä¢ Notifications API: \${'Notification' in window ? '‚úÖ' : '‚ùå'}\`, 'Notification' in window ? '#4CAF50' : '#f44336');
    }
  },
  
  showLifecycle: () => {
    clearOutput();
    log('üîÑ <strong>–ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª Service Worker</strong>', '#9C27B0');
    log('');
    
    const stages = [
      { name: 'Registration', desc: '–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è SW —á–µ—Ä–µ–∑ navigator.serviceWorker.register()', icon: 'üìù' },
      { name: 'Installing', desc: '–°–æ–±—ã—Ç–∏–µ install - –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ—Å—É—Ä—Å–æ–≤', icon: '‚¨áÔ∏è' },
      { name: 'Installed/Waiting', desc: 'SW —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –∂–¥–µ—Ç –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å —Å—Ç–∞—Ä—ã–π SW)', icon: '‚è≥' },
      { name: 'Activating', desc: '–°–æ–±—ã—Ç–∏–µ activate - –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä–æ–≥–æ –∫–µ—à–∞', icon: 'üîÑ' },
      { name: 'Activated', desc: 'SW –∞–∫—Ç–∏–≤–µ–Ω –∏ –≥–æ—Ç–æ–≤ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã', icon: '‚úÖ' },
      { name: 'Fetch/Message', desc: '–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π fetch –∏ message', icon: 'üåê' },
      { name: 'Idle', desc: 'SW –≤ —Ä–µ–∂–∏–º–µ –æ–∂–∏–¥–∞–Ω–∏—è —Å–æ–±—ã—Ç–∏–π', icon: 'üí§' },
      { name: 'Terminated', desc: 'SW –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –±—Ä–∞—É–∑–µ—Ä–æ–º –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –ø–∞–º—è—Ç–∏', icon: 'üõë' }
    ];
    
    stages.forEach((stage, i) => {
      log(\`\${i + 1}. \${stage.icon} <strong>\${stage.name}</strong>\`, '#2196F3');
      log(\`   \${stage.desc}\`, '#666');
      log('');
    });
    
    log('üí° <strong>–í–∞–∂–Ω–æ:</strong> SW –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –∏ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω –ø—Ä–∏ –Ω–æ–≤–æ–º —Å–æ–±—ã—Ç–∏–∏', '#FF9800');
  },
  
  showCaching: () => {
    clearOutput();
    log('üíæ <strong>–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤</strong>', '#4CAF50');
    log('');
    
    const installCode = \`// sw.js - —Å–æ–±—ã—Ç–∏–µ install
self.addEventListener('install', event => {
  const CACHE_NAME = 'my-app-v1';
  const urlsToCache = [
    '/',
    '/index.html',
    '/styles.css',
    '/script.js',
    '/logo.png'
  ];
  
  event.waitUntil(
    caches.open(CACHE_NAME)
      .then(cache => {
        console.log('–ö–µ—à –æ—Ç–∫—Ä—ã—Ç');
        return cache.addAll(urlsToCache);
      })
  );
  
  // –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π SW —Å—Ä–∞–∑—É
  self.skipWaiting();
});\`;
    
    log('–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Å–æ–±—ã—Ç–∏–∏ <strong>install</strong>:', '#666');
    output.innerHTML += highlightCode(installCode);
    
    log('');
    log('üîë <strong>–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã Cache API:</strong>', '#2196F3');
    log('  ‚Ä¢ caches.open(name) - –æ—Ç–∫—Ä—ã—Ç—å –∫–µ—à', '#666');
    log('  ‚Ä¢ cache.addAll(urls) - –¥–æ–±–∞–≤–∏—Ç—å –º–∞—Å—Å–∏–≤ URL', '#666');
    log('  ‚Ä¢ cache.add(url) - –¥–æ–±–∞–≤–∏—Ç—å –æ–¥–∏–Ω URL', '#666');
    log('  ‚Ä¢ cache.put(request, response) - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ç–≤–µ—Ç', '#666');
    log('  ‚Ä¢ cache.delete(request) - —É–¥–∞–ª–∏—Ç—å –∏–∑ –∫–µ—à–∞', '#666');
    log('  ‚Ä¢ caches.keys() - –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∫–µ—à–∏', '#666');
  },
  
  showFetch: () => {
    clearOutput();
    log('üåê <strong>–ü–µ—Ä–µ—Ö–≤–∞—Ç fetch-–∑–∞–ø—Ä–æ—Å–æ–≤</strong>', '#2196F3');
    log('');
    
    const fetchCode = \`// sw.js - —Å–æ–±—ã—Ç–∏–µ fetch
self.addEventListener('fetch', event => {
  event.respondWith(
    caches.match(event.request)
      .then(cachedResponse => {
        // –ï—Å–ª–∏ –µ—Å—Ç—å –≤ –∫–µ—à–µ - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º
        if (cachedResponse) {
          console.log('–ò–∑ –∫–µ—à–∞:', event.request.url);
          return cachedResponse;
        }
        
        // –ï—Å–ª–∏ –Ω–µ—Ç - –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –∏–∑ —Å–µ—Ç–∏
        return fetch(event.request)
          .then(response => {
            // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –æ—Ç–≤–µ—Ç–∞
            if (!response || response.status !== 200 || 
                response.type !== 'basic') {
              return response;
            }
            
            // –ö–ª–æ–Ω–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç –¥–ª—è –∫–µ—à–∞
            const responseToCache = response.clone();
            
            caches.open('my-app-v1')
              .then(cache => {
                cache.put(event.request, responseToCache);
              });
            
            return response;
          })
          .catch(() => {
            // Fallback –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–µ—Ç–∏
            return caches.match('/offline.html');
          });
      })
  );
});\`;
    
    log('–°—Ç—Ä–∞—Ç–µ–≥–∏—è: <strong>Cache First, then Network</strong>', '#666');
    output.innerHTML += highlightCode(fetchCode);
    
    log('');
    log('üìö <strong>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è:</strong>', '#FF9800');
    log('  1. Cache First - —Å–Ω–∞—á–∞–ª–∞ –∫–µ—à, –ø–æ—Ç–æ–º —Å–µ—Ç—å', '#666');
    log('  2. Network First - —Å–Ω–∞—á–∞–ª–∞ —Å–µ—Ç—å, –ø–æ—Ç–æ–º –∫–µ—à', '#666');
    log('  3. Cache Only - —Ç–æ–ª—å–∫–æ –∫–µ—à', '#666');
    log('  4. Network Only - —Ç–æ–ª—å–∫–æ —Å–µ—Ç—å', '#666');
    log('  5. Stale While Revalidate - –∫–µ—à + —Ñ–æ–Ω–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ', '#666');
  },
  
  showPWA: () => {
    clearOutput();
    log('üì± <strong>Service Workers –≤ Progressive Web Apps</strong>', '#E91E63');
    log('');
    
    log('üéØ <strong>–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ PWA:</strong>', '#2196F3');
    log('');
    
    const features = [
      { icon: 'üì¥', name: 'Offline —Ä–µ–∂–∏–º', desc: '–†–∞–±–æ—Ç–∞ –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ —á–µ—Ä–µ–∑ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ' },
      { icon: 'üîî', name: 'Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è', desc: '–û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –¥–∞–∂–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏' },
      { icon: 'üì≤', name: '–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ', desc: '–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω (manifest.json)' },
      { icon: '‚ö°', name: '–ë—ã—Å—Ç—Ä–∞—è –∑–∞–≥—Ä—É–∑–∫–∞', desc: '–ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ –∫–µ—à' },
      { icon: 'üîÑ', name: '–§–æ–Ω–æ–≤–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è', desc: 'Sync API –¥–ª—è –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π' },
      { icon: 'üìä', name: '–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ offline', desc: '–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–∞–∂–µ –±–µ–∑ —Å–µ—Ç–∏' }
    ];
    
    features.forEach(f => {
      log(\`\${f.icon} <strong>\${f.name}</strong>\`, '#4CAF50');
      log(\`   \${f.desc}\`, '#666');
      log('');
    });
    
    log('üè¢ <strong>–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:</strong>', '#9C27B0');
    log('  ‚Ä¢ Twitter Lite - PWA —Å offline —Ä–µ–∂–∏–º–æ–º', '#666');
    log('  ‚Ä¢ Starbucks - –∑–∞–∫–∞–∑ –∫–æ—Ñ–µ –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞', '#666');
    log('  ‚Ä¢ Pinterest - 60% —É–≤–µ–ª–∏—á–µ–Ω–∏–µ engagement', '#666');
    log('  ‚Ä¢ Telegram Web - –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä –≤ –±—Ä–∞—É–∑–µ—Ä–µ', '#666');
  },
  
  showCode: () => {
    clearOutput();
    log('üíª <strong>–ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä Service Worker</strong>', '#673AB7');
    log('');
    
    const registerCode = \`// main.js - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker
      .register('/sw.js')
      .then(registration => {
        console.log('SW registered:', registration.scope);
      })
      .catch(error => {
        console.error('SW registration failed:', error);
      });
  });
}\`;
    
    const swCode = \`// sw.js - –ø–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä
const CACHE_NAME = 'my-pwa-v1';
const OFFLINE_URL = '/offline.html';

// Install
self.addEventListener('install', event => {
  event.waitUntil(
    caches.open(CACHE_NAME).then(cache => 
      cache.addAll([
        '/',
        '/index.html',
        '/styles.css',
        '/app.js',
        OFFLINE_URL
      ])
    )
  );
  self.skipWaiting();
});

// Activate
self.addEventListener('activate', event => {
  event.waitUntil(
    caches.keys().then(cacheNames =>
      Promise.all(
        cacheNames
          .filter(name => name !== CACHE_NAME)
          .map(name => caches.delete(name))
      )
    )
  );
  self.clients.claim();
});

// Fetch
self.addEventListener('fetch', event => {
  if (event.request.mode === 'navigate') {
    event.respondWith(
      fetch(event.request).catch(() =>
        caches.match(OFFLINE_URL)
      )
    );
  } else {
    event.respondWith(
      caches.match(event.request).then(response =>
        response || fetch(event.request)
      )
    );
  }
});\`;
    
    log('1Ô∏è‚É£ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–º —Ñ–∞–π–ª–µ:', '#666');
    output.innerHTML += highlightCode(registerCode);
    
    log('');
    log('2Ô∏è‚É£ –ö–æ–¥ Service Worker:', '#666');
    output.innerHTML += highlightCode(swCode);
    
    log('');
    log('‚úÖ <strong>–ì–æ—Ç–æ–≤–æ!</strong> –¢–µ–ø–µ—Ä—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç offline', '#4CAF50');
  }
};

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
checkSupport();

// –ö–Ω–æ–ø–∫–∏
document.querySelectorAll('.demo-btn').forEach(btn => {
  btn.style.cssText = \`
    padding: 12px 20px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    text-align: left;
    transition: all 0.2s;
  \`;
  
  btn.addEventListener('mouseover', () => {
    btn.style.transform = 'translateX(3px)';
    btn.style.boxShadow = '0 4px 12px rgba(0,0,0,0.2)';
  });
  
  btn.addEventListener('mouseout', () => {
    btn.style.transform = 'translateX(0)';
    btn.style.boxShadow = 'none';
  });
});

document.querySelector('#checkSupport').addEventListener('click', demos.checkSupport);
document.querySelector('#showLifecycle').addEventListener('click', demos.showLifecycle);
document.querySelector('#showCaching').addEventListener('click', demos.showCaching);
document.querySelector('#showFetch').addEventListener('click', demos.showFetch);
document.querySelector('#showPWA').addEventListener('click', demos.showPWA);
document.querySelector('#showCode').addEventListener('click', demos.showCode);

output.innerHTML = '<div style="color: #666; text-align: center; padding: 40px;">üëÜ –í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è</div>';
```

</Sandpack>
