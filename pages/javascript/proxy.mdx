import { Sandpack } from '@codesandbox/sandpack-react'

## JavaScript: –ú–æ–∑–≥–∏ - –£—Ä–æ–∫ "Proxy"

Proxy –≤ JavaScript - —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–∞–∑–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –æ–±—ä–µ–∫—Ç–∞–º–∏. –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Å–≤–æ–π—Å—Ç–≤–∞–º, –º–µ—Ç–æ–¥—ã –∏ –¥—Ä—É–≥–∏–µ –∞—Å–ø–µ–∫—Ç—ã –æ–±—ä–µ–∫—Ç–∞, –æ—Ç–∫—Ä—ã–≤–∞—è –¥–≤–µ—Ä–∏ –¥–ª—è –≥–∏–±–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è.

### –ö–æ–Ω—Ü–µ–ø—Ü–∏—è Proxy

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —Å–µ–±–µ Proxy –∫–∞–∫ –ø–æ—Å—Ä–µ–¥–Ω–∏–∫–∞ –º–µ–∂–¥—É –≤–∞–º–∏ –∏ –æ–±—ä–µ–∫—Ç–æ–º. –í—ã –æ–±—Ä–∞—â–∞–µ—Ç–µ—Å—å –∫ –æ–±—ä–µ–∫—Ç—É —á–µ—Ä–µ–∑ Proxy, –∏ Proxy —Ä–µ—à–∞–µ—Ç, –∫–∞–∫ –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –≤–∞—à –∑–∞–ø—Ä–æ—Å.  –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º –¥–æ–±–∞–≤–ª—è—Ç—å –ª–æ–≥–∏–∫—É –ø–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –æ–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è, –∑–∞–ø–∏—Å–∏ –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏—è –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —Å –∏—Å—Ö–æ–¥–Ω—ã–º –æ–±—ä–µ–∫—Ç–æ–º.

```javascript
const target = {
  name: "–û–±—ã—á–Ω—ã–π –û–±—ä–µ–∫—Ç",
  age: 30
};

const handler = {
  get: function(target, property, receiver) {
    console.log(`–ü–æ–ø—ã—Ç–∫–∞ —á—Ç–µ–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤–∞: ${property}`);
    return Reflect.get(target, property, receiver); // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Reflect
  },
  set: function(target, property, value, receiver) {
    console.log(`–ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø–∏—Å–∏ —Å–≤–æ–π—Å—Ç–≤–∞: ${property} —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º: ${value}`);
    target[property] = value;
    return true; // –í–∞–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å true –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –∑–∞–ø–∏—Å–∏
  }
};

const proxy = new Proxy(target, handler);

console.log(proxy.name); // –í—ã–≤–æ–¥: "–ü–æ–ø—ã—Ç–∫–∞ —á—Ç–µ–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤–∞: name", "–û–±—ã—á–Ω—ã–π –û–±—ä–µ–∫—Ç"
proxy.age = 35; // –í—ã–≤–æ–¥: "–ü–æ–ø—ã—Ç–∫–∞ –∑–∞–ø–∏—Å–∏ —Å–≤–æ–π—Å—Ç–≤–∞: age —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º: 35"
console.log(target.age); // –í—ã–≤–æ–¥: 35 (–∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –æ–±—ä–µ–∫—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–æ)
```

–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ `handler` —Å–æ–¥–µ—Ä–∂–∏—Ç –º–µ—Ç–æ–¥—ã `get` –∏ `set`, –∫–æ—Ç–æ—Ä—ã–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç –æ–ø–µ—Ä–∞—Ü–∏–∏ —á—Ç–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏ —Å–≤–æ–π—Å—Ç–≤.  `Reflect.get` –∏ `Reflect.set` –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å –∏—Å—Ö–æ–¥–Ω—ã–º –æ–±—ä–µ–∫—Ç–æ–º. –í–∞–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Reflect`, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ø—Ä–æ–±–ª–µ–º —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º `this` –∏ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ–º.

### –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞

1.  **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:**

```javascript
const validator = {
  set: function(obj, prop, value) {
    if (prop === 'age') {
      if (!Number.isInteger(value)) {
        throw new TypeError('–í–æ–∑—Ä–∞—Å—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º');
      }
      if (value < 0) {
        throw new TypeError('–í–æ–∑—Ä–∞—Å—Ç –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º');
      }
    }

    obj[prop] = value;
    return true;
  }
};

const person = new Proxy({}, validator);

person.age = 30;
console.log(person.age); // 30

try {
  person.age = -10; // –í—ã–±—Ä–æ—Å–∏—Ç –æ—à–∏–±–∫—É
} catch (e) {
  console.error(e);
}
```

2.  **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–≤–æ–π—Å—Ç–≤–∞–º:**

```javascript
const logHandler = {
  get: function(target, property) {
    console.log(`–î–æ—Å—Ç—É–ø –∫ —Å–≤–æ–π—Å—Ç–≤—É: ${property}`);
    return target[property];
  }
};

const data = { name: "–ò–≤–∞–Ω", city: "–ú–æ—Å–∫–≤–∞" };
const loggedData = new Proxy(data, logHandler);

console.log(loggedData.name); // –í—ã–≤–æ–¥: "–î–æ—Å—Ç—É–ø –∫ —Å–≤–æ–π—Å—Ç–≤—É: name", "–ò–≤–∞–Ω"
```

### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä

Proxy –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ Vue.js –∏ MobX, –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. –û–Ω–∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.  –ù–∞–ø—Ä–∏–º–µ—Ä, Vue.js –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Proxy (–∏–ª–∏ Object.defineProperty –≤ —Å—Ç–∞—Ä—ã—Ö –±—Ä–∞—É–∑–µ—Ä–∞—Ö) –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –¥–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∏ –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —á–∞—Å—Ç–µ–π DOM.

–í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API Proxy –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è "–ª–µ–Ω–∏–≤—ã—Ö" –æ–±—ä–µ–∫—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –Ω–∏–º.

### –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã

*   Proxy –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –∏ –∏–∑–º–µ–Ω—è—Ç—å –±–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –æ–±—ä–µ–∫—Ç–∞–º–∏.
*   `Reflect` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å –∏—Å—Ö–æ–¥–Ω—ã–º –æ–±—ä–µ–∫—Ç–æ–º.
*   Proxy –ø–æ–ª–µ–∑–µ–Ω –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è, —Ä–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∏ –¥—Ä—É–≥–∏—Ö –∑–∞–¥–∞—á.
*   `get`, `set`, `deleteProperty`, `has`, `construct`, `apply` - —ç—Ç–æ –ª–∏—à—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ Proxy.
*   –ù–µ –≤—Å–µ –±—Ä–∞—É–∑–µ—Ä—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç Proxy (–æ—Å–æ–±–µ–Ω–Ω–æ —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏), –ø–æ—ç—Ç–æ–º—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —É—á–∏—Ç—ã–≤–∞—Ç—å —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å.

### –ü—Ä–∞–∫—Ç–∏–∫–∞

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ:

<Sandpack
  template="vanilla"
  files={{
    '/index.js': `index.js
// –°–æ–∑–¥–∞–µ–º –ª–æ–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
const activityLog = [];

function addLog(message, type = 'info') {
  activityLog.push({ message, type, time: new Date().toLocaleTimeString() });
  updateLog();
}

// –¶–µ–ª–µ–≤–æ–π –æ–±—ä–µ–∫—Ç
const user = {
  name: 'Alice',
  age: 25,
  email: 'alice@example.com'
};

// Handler —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ª–æ–≤—É—à–∫–∞–º–∏
const handler = {
  get(target, property) {
    addLog(\`üìñ –ß—Ç–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞: \${property} = \${target[property]}\`, 'get');
    return target[property];
  },
  
  set(target, property, value) {
    // –í–∞–ª–∏–¥–∞—Ü–∏—è
    if (property === 'age' && (!Number.isInteger(value) || value < 0 || value > 150)) {
      addLog(\`‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–æ: age –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º –æ—Ç 0 –¥–æ 150\`, 'error');
      return false;
    }
    
    if (property === 'email' && !value.includes('@')) {
      addLog(\`‚ùå –û—Ç–∫–ª–æ–Ω–µ–Ω–æ: email –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å @\`, 'error');
      return false;
    }
    
    addLog(\`‚úèÔ∏è –ó–∞–ø–∏—Å—å —Å–≤–æ–π—Å—Ç–≤–∞: \${property} = \${value}\`, 'set');
    target[property] = value;
    updateUserDisplay();
    return true;
  },
  
  deleteProperty(target, property) {
    addLog(\`üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞: \${property}\`, 'delete');
    delete target[property];
    updateUserDisplay();
    return true;
  },
  
  has(target, property) {
    addLog(\`üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è: "\${property}" in user\`, 'has');
    return property in target;
  }
};

// –°–æ–∑–¥–∞–µ–º Proxy
const proxyUser = new Proxy(user, handler);

const app = document.getElementById('app');

app.innerHTML = \`
  <div class="section">
    <h2>üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å (—á–µ—Ä–µ–∑ Proxy)</h2>
    <div id="userDisplay"></div>
  </div>
  
  <div class="section">
    <h2>üéÆ –î–µ–π—Å—Ç–≤–∏—è</h2>
    <div class="actions">
      <div class="action-group">
        <h3>–ß—Ç–µ–Ω–∏–µ</h3>
        <button onclick="readName()">–ü—Ä–æ—á–∏—Ç–∞—Ç—å name</button>
        <button onclick="readAge()">–ü—Ä–æ—á–∏—Ç–∞—Ç—å age</button>
      </div>
      
      <div class="action-group">
        <h3>–ó–∞–ø–∏—Å—å</h3>
        <input type="number" id="newAge" placeholder="–ù–æ–≤—ã–π –≤–æ–∑—Ä–∞—Å—Ç" value="30">
        <button onclick="setAge()">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å age</button>
        
        <input type="text" id="newEmail" placeholder="–ù–æ–≤—ã–π email" value="bob@test.com">
        <button onclick="setEmail()">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å email</button>
      </div>
      
      <div class="action-group">
        <h3>–î—Ä—É–≥–æ–µ</h3>
        <button onclick="checkProperty()">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å "name" in user</button>
        <button onclick="deleteEmail()">–£–¥–∞–ª–∏—Ç—å email</button>
      </div>
    </div>
  </div>
  
  <div class="section">
    <h2>üìã –õ–æ–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</h2>
    <button onclick="clearLog()" style="background: #f44336;">–û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥</button>
    <div id="log"></div>
  </div>
\`;

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
function updateUserDisplay() {
  const display = document.getElementById('userDisplay');
  display.innerHTML = \`
    <pre>\${JSON.stringify(user, null, 2)}</pre>
  \`;
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–æ–≥–∞
function updateLog() {
  const logDiv = document.getElementById('log');
  const logs = activityLog.slice(-10).reverse().map(entry => {
    const colors = {
      get: '#2196f3',
      set: '#4caf50',
      delete: '#f44336',
      has: '#ff9800',
      error: '#d32f2f',
      info: '#757575'
    };
    return \`<div class="log-entry" style="border-left-color: \${colors[entry.type]}">
      <span class="time">[\${entry.time}]</span> \${entry.message}
    </div>\`;
  }).join('');
  
  logDiv.innerHTML = logs || '<div class="empty">–õ–æ–≥ –ø—É—Å—Ç</div>';
}

// –î–µ–π—Å—Ç–≤–∏—è
window.readName = () => {
  const name = proxyUser.name;
  console.log('name:', name);
};

window.readAge = () => {
  const age = proxyUser.age;
  console.log('age:', age);
};

window.setAge = () => {
  const newAge = parseInt(document.getElementById('newAge').value);
  proxyUser.age = newAge;
};

window.setEmail = () => {
  const newEmail = document.getElementById('newEmail').value;
  proxyUser.email = newEmail;
};

window.checkProperty = () => {
  const exists = 'name' in proxyUser;
  console.log('"name" in proxyUser:', exists);
};

window.deleteEmail = () => {
  delete proxyUser.email;
};

window.clearLog = () => {
  activityLog.length = 0;
  updateLog();
};

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
updateUserDisplay();
updateLog();

console.log('üí° –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –æ–±—ä–µ–∫—Ç–æ–º –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—é—Ç—Å—è Proxy!');
\`\`\`

\`\`\`css styles.css
body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  padding: 20px;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  margin: 0;
}

#app {
  max-width: 900px;
  margin: 0 auto;
}

.section {
  background: white;
  border-radius: 12px;
  padding: 24px;
  margin-bottom: 20px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

h2, h3 {
  margin: 0 0 16px 0;
  color: #333;
}

#userDisplay pre {
  background: #e3f2fd;
  padding: 16px;
  border-radius: 8px;
  border-left: 4px solid #2196f3;
  font-family: 'Courier New', monospace;
  font-size: 15px;
}

.actions {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 16px;
}

.action-group {
  background: #f8f9fa;
  padding: 16px;
  border-radius: 8px;
}

.action-group h3 {
  font-size: 1em;
  margin-bottom: 12px;
  color: #667eea;
}

input {
  width: 100%;
  padding: 8px 12px;
  border: 2px solid #e0e0e0;
  border-radius: 6px;
  font-size: 14px;
  margin-bottom: 8px;
  box-sizing: border-box;
}

input:focus {
  outline: none;
  border-color: #667eea;
}

button {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  border: none;
  padding: 10px 16px;
  border-radius: 6px;
  font-size: 14px;
  font-weight: bold;
  cursor: pointer;
  width: 100%;
  margin-bottom: 8px;
  transition: transform 0.2s;
}

button:hover {
  transform: scale(1.02);
}

button:active {
  transform: scale(0.98);
}

#log {
  margin-top: 12px;
  max-height: 300px;
  overflow-y: auto;
}

.log-entry {
  padding: 10px 12px;
  background: #f8f9fa;
  border-left: 4px solid;
  border-radius: 4px;
  margin-bottom: 8px;
  font-size: 14px;
  font-family: 'Courier New', monospace;
}

.time {
  color: #757575;
  font-size: 12px;
  margin-right: 8px;
}

.empty {
  color: #9e9e9e;
  text-align: center;
  padding: 20px;
  font-style: italic;
}`
  }}
/>
