## JavaScript: –ú–æ–∑–≥–∏ - –£—Ä–æ–∫ "Async Iterators"

Async Iterators ‚Äì —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤ JavaScript –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ –ø–æ—Ç–æ–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö. –û–Ω–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –∏—Ç–µ—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –ø–æ –¥–∞–Ω–Ω—ã–º, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏—Ö–æ–¥—è—Ç –Ω–µ —Å—Ä–∞–∑—É, –∞ –ø–æ –º–µ—Ä–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π, —Ç–∞–∫–∏—Ö –∫–∞–∫ –∑–∞–ø—Ä–æ—Å—ã –∫ API –∏–ª–∏ —á—Ç–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤.

### –ü—Ä–æ—Ü–µ—Å—Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏

```mermaid
flowchart TD
    Start[for await...of] --> CallNext[–í—ã–∑–æ–≤ iterator.next()]
    CallNext --> Wait[–û–∂–∏–¥–∞–Ω–∏–µ Promise]
    Wait --> Check{done?}
    Check -- No --> Yield[–ü–æ–ª—É—á–µ–Ω–∏–µ value]
    Yield --> Body[–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–µ–ª–∞ —Ü–∏–∫–ª–∞]
    Body --> CallNext
    Check -- Yes --> End[–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ü–∏–∫–ª–∞]

    style Wait fill:#fff4dd,stroke:#d4a017
    style Body fill:#e1f5fe,stroke:#01579b
```
*–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã —Ü–∏–∫–ª–∞ `for await...of`.*

### –ß—Ç–æ —Ç–∞–∫–æ–µ Async Iterators?

–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ —Å–µ–±–µ –æ–±—ã—á–Ω—ã–π –∏—Ç–µ—Ä–∞—Ç–æ—Ä: –æ–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –ø–æ–ª—É—á–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö. Async Iterator –¥–µ–ª–∞–µ—Ç —Ç–æ –∂–µ —Å–∞–º–æ–µ, –Ω–æ –∫–∞–∂–¥–æ–µ "–ø–æ–ª—É—á–µ–Ω–∏–µ" –∑–Ω–∞—á–µ–Ω–∏—è –º–æ–∂–µ—Ç –±—ã—Ç—å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–µ–π.  –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –∏—Ç–µ—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å Promise, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–∑—Ä–µ—à–∏—Ç—Å—è –≤ —Å–ª–µ–¥—É—é—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.

–ö–ª—é—á–µ–≤—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã Async Iterator:

*   `Symbol.asyncIterator`: –°–∏–º–≤–æ–ª, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏–π –º–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Async Iterator.
*   `next()`: –ú–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç Promise. –≠—Ç–æ—Ç Promise —Ä–∞–∑—Ä–µ—à–∞–µ—Ç—Å—è –≤ –æ–±—ä–µ–∫—Ç –≤–∏–¥–∞ `{ value: any, done: boolean }`, –≥–¥–µ `value` ‚Äì —Å–ª–µ–¥—É—é—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –∞ `done` ‚Äì —Ñ–ª–∞–≥, —É–∫–∞–∑—ã–≤–∞—é—â–∏–π –Ω–∞ –æ–∫–æ–Ω—á–∞–Ω–∏–µ –∏—Ç–µ—Ä–∞—Ü–∏–∏.

### –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞

```javascript
// –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ –∑–∞–¥–µ—Ä–∂–∫–∏
async function delay(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

// –ü—Ä–∏–º–µ—Ä Async Iterable
const asyncIterable = {
  [Symbol.asyncIterator]() {
    let i = 0;
    return {
      async next() {
        await delay(500); // –ò–º–∏—Ç–∏—Ä—É–µ–º –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—É—é –æ–ø–µ—Ä–∞—Ü–∏—é
        if (i < 3) {
          return { value: i++, done: false };
        } else {
          return { value: undefined, done: true };
        }
      }
    };
  }
};

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Async Iterator —Å –ø–æ–º–æ—â—å—é async/await
async function iterate() {
  for await (const value of asyncIterable) {
    console.log(value); // –í—ã–≤–æ–¥: 0, 1, 2 (—Å –∑–∞–¥–µ—Ä–∂–∫–æ–π –≤ 500–º—Å –º–µ–∂–¥—É –∫–∞–∂–¥—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º)
  }
  console.log("–ò—Ç–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞");
}

iterate();
```

–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ `asyncIterable` —è–≤–ª—è–µ—Ç—Å—è –æ–±—ä–µ–∫—Ç–æ–º, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç Async Iterator.  –§—É–Ω–∫—Ü–∏—è `iterate` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ü–∏–∫–ª `for await...of`, —á—Ç–æ–±—ã –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –ø–µ—Ä–µ–±–∏—Ä–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –∏—Ç–µ—Ä–∞—Ç–æ—Ä–æ–º.

### –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø—Ä–∏–º–µ—Ä —Å API

```javascript
async function* fetchUsers(url) {
  let page = 1;
  while (true) {
    const response = await fetch(`${url}?page=${page}`);
    const data = await response.json();

    if (data.length === 0) {
      return; // –ó–∞–≤–µ—Ä—à–∞–µ–º –∏—Ç–µ—Ä–∞—Ü–∏—é, –µ—Å–ª–∏ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö
    }

    for (const user of data) {
      yield user; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    }

    page++;
  }
}

async function displayUsers() {
  const userGenerator = fetchUsers('https://reqres.in/api/users'); // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π API

  for await (const user of userGenerator) {
    console.log(user.first_name, user.last_name);
  }
}

displayUsers();
```

–≠—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Async Generator Function (—Ñ—É–Ω–∫—Ü–∏—é —Å `async function*`), —á—Ç–æ–±—ã –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–æ –∏–∑ API.  –§—É–Ω–∫—Ü–∏—è `yield` –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ –º–µ—Ä–µ –∏—Ö –ø–æ–ª—É—á–µ–Ω–∏—è, –Ω–µ –¥–æ–∂–∏–¥–∞—è—Å—å –∑–∞–≥—Ä—É–∑–∫–∏ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü.

### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä

Async Iterators —à–∏—Ä–æ–∫–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ Node.js –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ—Ç–æ–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö (streams), –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤ –∏–ª–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.  –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ —á–∞—Å—Ç—è–º–∏, Async Iterators –ø–æ–∑–≤–æ–ª—è—é—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ.  –¢–∞–∫–∂–µ, –æ–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, –¥–ª—è –ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö.  –í–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞—Ö, —Ç–∞–∫–∏—Ö –∫–∞–∫ React, –∏—Ö –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–≤–æ–π –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

### –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã

*   Async Iterators –ø–æ–∑–≤–æ–ª—è—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ –ø–æ—Ç–æ–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö.
*   –û–Ω–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `Symbol.asyncIterator` –∏ –º–µ—Ç–æ–¥ `next()`, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π Promise.
*   –¶–∏–∫–ª `for await...of` –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏.
*   Async Generator Functions (—Å `async function*`) —É–ø—Ä–æ—â–∞—é—Ç —Å–æ–∑–¥–∞–Ω–∏–µ Async Iterators.
*   Async Iterators –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö, –ø–æ—Å—Ç—É–ø–∞—é—â–∏—Ö –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑ API –∏–ª–∏ —Ñ–∞–π–ª–æ–≤).

### –ü—Ä–∞–∫—Ç–∏–∫–∞

–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –≤ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–º —Ä–µ–¥–∞–∫—Ç–æ—Ä–µ:

import { Sandpack } from "@codesandbox/sandpack-react";

<Sandpack
  template="vanilla"
  files={{
    "/index.js": `// –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ –∑–∞–¥–µ—Ä–∂–∫–∏
async function delay(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

// –ü—Ä–∏–º–µ—Ä Async Iterable
const asyncIterable = {
  [Symbol.asyncIterator]() {
    let i = 0;
    return {
      async next() {
        await delay(500);
        if (i < 5) {
          return { value: i++, done: false };
        }
        return { value: undefined, done: true };
      }
    };
  }
};

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Async Iterator
async function iterate() {
  const output = document.getElementById('output');
  output.innerHTML = '<p>–ù–∞—á–∏–Ω–∞–µ–º –∏—Ç–µ—Ä–∞—Ü–∏—é...</p>';
  
  for await (const value of asyncIterable) {
    output.innerHTML += \`<p>–ó–Ω–∞—á–µ–Ω–∏–µ: \${value}</p>\`;
  }
  
  output.innerHTML += '<p><strong>–ò—Ç–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!</strong></p>';
}

// –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
iterate();`,
    "/index.html": `<!DOCTYPE html>
<html>
<head>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    #output {
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    #output p {
      margin: 8px 0;
      padding: 8px;
      background: #e3f2fd;
      border-left: 4px solid #2196f3;
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <h2>üîÑ Async Iterator Demo</h2>
  <div id="output"></div>
  <script src="/index.js"></script>
</body>
</html>`
  }}
  options={{
    showNavigator: false,
    showLineNumbers: true,
    editorHeight: 400
  }}
/>
