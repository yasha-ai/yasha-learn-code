## JavaScript: Объекты


![Иллюстрация к уроку](/lessons/javascript-objects.png)
Объекты — это фундаментальная структура данных в JavaScript, позволяющая хранить коллекции данных в виде пар "ключ-значение". Ключи (или имена свойств) — это всегда строки (или символы), а значения могут быть любыми типами данных, включая другие объекты и функции.

### Основы: Создание и Доступ

Самый распространенный способ создания объекта — использование литерала объекта `{}`.

```javascript
// Создание объекта с использованием литерала
const user = {
  name: 'Алиса',       // Свойство name со строковым значением
  age: 30,             // Свойство age с числовым значением
  isAdmin: false       // Свойство isAdmin с булевым значением
};

console.log(user.name);    // Доступ к свойству через точку: 'Алиса'
console.log(user['age']);  // Доступ к свойству через скобки: 30

// Скобочная нотация полезна, когда имя свойства динамическое
const key = 'isAdmin';
console.log(user[key]);    // false
```

### Добавление, Изменение и Удаление Свойств

Свойства объектов можно легко добавлять, изменять и удалять.

```javascript
const product = {
  name: 'Ноутбук',
  price: 1200
};

product.quantity = 5;     // Добавление нового свойства
product['price'] = 1150;  // Изменение существующего свойства

console.log(product);     // { name: 'Ноутбук', price: 1150, quantity: 5 }

delete product.quantity;  // Удаление свойства
console.log(product);     // { name: 'Ноутбук', price: 1150 }
```

### Методы Объектов

Функции, хранящиеся как свойства объекта, называются методами. Они позволяют объектам выполнять действия. Ключевое слово `this` внутри метода ссылается на сам объект.

```javascript
const person = {
  firstName: 'Боб',
  lastName: 'Марли',
  greet() {
    // Внутри метода `this` указывает на текущий объект (person)
    console.log(`Привет, меня зовут ${this.firstName} ${this.lastName}!`);
  },
  // ES6 сокращенная запись для методов (предпочтительна)
  introduce() {
      console.log(`Я ${this.firstName}.`);
  }
};

person.greet();     // Привет, меня зовут Боб Марли!
person.introduce(); // Я Боб.
```

### Современные Возможности (ES6+)

**Сокращенные имена свойств (Shorthand Property Names):**
Если имя переменной совпадает с именем свойства, можно использовать сокращенную запись.

```javascript
const userName = 'Чарли';
const userAge = 25;

const newUser = {
  userName, // То же что userName: userName
  userAge   // То же что userAge: userAge
};
console.log(newUser); // { userName: 'Чарли', userAge: 25 }
```

**Деструктуризация объектов:**
Удобный способ извлекать свойства из объекта в отдельные переменные.

```javascript
const settings = {
  theme: 'dark',
  fontSize: 16,
  notifications: true
};

const { theme, fontSize } = settings; // Извлекаем theme и fontSize
console.log(theme, fontSize);         // dark 16

const { notifications: notify } = settings; // Извлекаем notifications и переименовываем в notify
console.log(notify);                  // true
```

**Spread-оператор (`...`) для объектов:**
Позволяет копировать свойства объекта или объединять несколько объектов.

```javascript
const userProfile = { name: 'Диана', email: 'diana@example.com' };
const userPrefs = { theme: 'light', lang: 'ru' };

// Копирование объекта
const copiedProfile = { ...userProfile };
console.log(copiedProfile); // { name: 'Диана', email: 'diana@example.com' }

// Объединение объектов
const fullUser = { ...userProfile, ...userPrefs, isActive: true };
console.log(fullUser);
// { name: 'Диана', email: 'diana@example.com', theme: 'light', lang: 'ru', isActive: true }

// Переопределение свойств при объединении
const updatedUser = { ...userProfile, email: 'new_diana@example.com' };
console.log(updatedUser); // email будет перезаписан
```

### Итерация и Утилиты `Object`

Методы `Object.keys()`, `Object.values()` и `Object.entries()` позволяют получить массивы ключей, значений или пар "ключ-значение" соответственно.

```javascript
const car = {
  make: 'Honda',
  model: 'Civic',
  year: 2020
};

console.log(Object.keys(car));   // [ 'make', 'model', 'year' ]
console.log(Object.values(car)); // [ 'Honda', 'Civic', 2020 ]
console.log(Object.entries(car)); // [ ['make', 'Honda'], ['model', 'Civic'], ['year', 2020] ]

// Использование в циклах
for (const [key, value] of Object.entries(car)) {
  console.log(`${key}: ${value}`);
}
// make: Honda
// model: Civic
// year: 2020
```

### Типичные Ошибки и Продвинутые Концепции

**Мутация объектов (передача по ссылке):**
Объекты в JavaScript передаются по ссылке, а не по значению. Это значит, что если вы присвоите один объект другому, они будут ссылаться на одну и ту же область памяти.

```javascript
const original = { value: 10 };
const reference = original; // reference теперь ссылается на тот же объект
reference.value = 20;       // Изменяем value через reference
console.log(original.value); // 20! original тоже изменился.
```
Для создания независимой копии используйте spread-оператор или `Object.assign()`:
```javascript
const independentCopy = { ...original }; // Создает поверхностную копию
independentCopy.value = 30;
console.log(original.value);       // 20 (original не изменился)
console.log(independentCopy.value); // 30
```

**Геттеры и Сеттеры:**
Позволяют выполнять функции при доступе к свойству или его изменении, обеспечивая контролируемый интерфейс.

```javascript
const rectangle = {
  _width: 5, // Принято начинать имя свойства с '_' для внутренних данных
  _height: 10,
  get area() { // Геттер вызывается при обращении к rectangle.area
    return this._width * this._height;
  },
  set dimensions(values) { // Сеттер вызывается при присваивании rectangle.dimensions = [...]
    if (Array.isArray(values) && values.length === 2) {
      this._width = values[0];
      this._height = values[1];
    }
  }
};
console.log(rectangle.area); // 50
rectangle.dimensions = [6, 12];
console.log(rectangle.area); // 72
```

### Практика и Советы

*   **Используйте `const` для объектов:** Хотя свойства объекта можно менять, саму ссылку на объект лучше объявлять через `const`, чтобы избежать случайного переприсваивания.
*   **Иммутабельность:** Старайтесь не изменять объекты напрямую, если это возможно. Вместо этого создавайте новые объекты с нужными изменениями, используя spread-оператор или `Object.assign()`. Это делает код предсказуемее, особенно в реактивных фреймворках.
*   **Глубокое клонирование:** Spread-оператор делает поверхностную копию. Если внутри объекта есть другие объекты, они по-прежнему будут переданы по ссылке. Для глубокого клонирования используйте библиотеки (например, Lodash `cloneDeep`) или `JSON.parse(JSON.stringify(obj))` для простых случаев (без функций, дат и т.д.).
*   **Читаемость:** Называйте ключи осмысленно. Используйте `camelCase` для ключей.

Объекты — это основа JavaScript. Понимание того, как они работают, и эффективное использование их возможностей является ключевым для написания чистого, мощного и поддерживаемого кода.


## Интерактивный пример

<Sandpack
  template="vanilla"
  files={{
    "/index.html": `<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JavaScript Объекты</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <div class="container">
    <h1>JavaScript Объекты</h1>
    <div id="user-info"></div>
    <button id="update-age">Увеличить возраст</button>
    <input type="text" id="new-name" placeholder="Новое имя">
    <button id="update-name">Изменить имя</button>
  </div>
  <\/body>
  <script src="/index.js"><\/script>
</html>`,
    "/styles.css": `body {
  font-family: sans-serif;
  background-color: #222;
  color: #eee;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  margin: 0;
}

.container {
  background-color: #333;
  padding: 20px;
  border-radius: 8px;
  text-align: center;
}

button {
  background-color: #4CAF50;
  border: none;
  color: white;
  padding: 10px 20px;
  text-align: center;
  text-decoration: none;
  display: inline-block;
  font-size: 16px;
  margin: 4px 2px;
  cursor: pointer;
  border-radius: 4px;
}

input[type=text] {
  padding: 10px;
  margin: 5px;
  border-radius: 4px;
  border: 1px solid #ccc;
}
`,
    "/index.js": `// Создание объекта user
const user = {
  name: 'Алиса',
  age: 30,
  city: 'Москва',
  greet: function() {
    return \`Привет, меня зовут \${'this.name'} и мне \${'this.age'} лет.\`;
  }
};

// Функция для отображения информации о пользователе в HTML
function displayUserInfo() {
  const userInfoDiv = document.getElementById('user-info');
  userInfoDiv.innerHTML = \`
    <p>Имя: \${'user.name'}</p>
    <p>Возраст: \${'user.age'}</p>
    <p>Город: \${'user.city'}</p>
    <p>\${'user.greet()'}</p>
  \`;
}

// Вызываем функцию для отображения информации при загрузке страницы
displayUserInfo();

// Обработчик события для кнопки "Увеличить возраст"
document.getElementById('update-age').addEventListener('click', function() {
  user.age++; // Увеличиваем возраст пользователя
  displayUserInfo(); // Обновляем отображение информации
});

// Обработчик события для кнопки "Изменить имя"
document.getElementById('update-name').addEventListener('click', function() {
  const newName = document.getElementById('new-name').value;
  if (newName) {
    user.name = newName; // Изменяем имя пользователя
    displayUserInfo(); // Обновляем отображение информации
    document.getElementById('new-name').value = ''; // Очищаем поле ввода
  }
});
`
  }}
  options={{
    showNavigator: false,
    showLineNumbers: true,
    editorHeight: 400
  }}
/>
