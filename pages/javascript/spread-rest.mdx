import { Sandpack } from '@codesandbox/sandpack-react'

# JavaScript: Мозги. Урок 3: Spread и Rest операторы

Привет! Сегодня мы разберемся с двумя очень полезными операторами в JavaScript: Spread и Rest. Они позволяют элегантно работать с массивами и объектами, делая код чище и понятнее.

## Spread оператор (...)

Spread оператор (оператор расширения) позволяет "расширить" итерируемый объект (например, массив или строку) в местах, где ожидается ноль или более аргументов (для вызовов функций) или элементов (для литералов массивов).  Проще говоря, он "распаковывает" элементы.

**Пример 1: Копирование массива**

```javascript
const arr1 = [1, 2, 3];
const arr2 = [...arr1]; // Создает новую копию arr1

console.log(arr2); // Вывод: [1, 2, 3]
console.log(arr1 === arr2); // Вывод: false (это разные массивы)
```

**Пример 2: Объединение массивов**

```javascript
const arr1 = [1, 2, 3];
const arr2 = [4, 5, 6];
const combinedArr = [...arr1, ...arr2];

console.log(combinedArr); // Вывод: [1, 2, 3, 4, 5, 6]
```

**Пример 3: Передача аргументов функции**

```javascript
function sum(x, y, z) {
  return x + y + z;
}

const numbers = [1, 2, 3];
console.log(sum(...numbers)); // Вывод: 6
```

## Rest оператор (...)

Rest оператор позволяет представить неопределенное количество аргументов функции в виде массива. Он собирает "остаток" аргументов. Rest оператор всегда должен быть последним параметром в объявлении функции.

**Пример 1: Сбор аргументов в функцию**

```javascript
function myFunc(a, b, ...args) {
  console.log("a:", a);
  console.log("b:", b);
  console.log("args:", args); // args - это массив
}

myFunc(1, 2, 3, 4, 5);
// Вывод:
// a: 1
// b: 2
// args: [3, 4, 5]
```

**Пример 2: Деструктуризация массива**

```javascript
const [first, second, ...rest] = [1, 2, 3, 4, 5];

console.log(first);   // Вывод: 1
console.log(second);  // Вывод: 2
console.log(rest);    // Вывод: [3, 4, 5]
```

## Жизненный пример

В React, Spread оператор очень часто используется для обновления состояния компонента.  Предположим, у вас есть объект состояния и вы хотите обновить только одно свойство.

```javascript
// Пример в React (псевдокод)

class MyComponent extends React.Component {
  constructor(props) {
    super(props);
    this.state = {
      name: "John",
      age: 30,
      city: "New York"
    };
  }

  updateName = (newName) => {
    this.setState({
      ...this.state, // Копируем все существующие свойства состояния
      name: newName  // Перезаписываем только свойство name
    });
  }

  render() {
    return (
      <div>
        <p>Name: {this.state.name}</p>
        <button onClick={() => this.updateName("Jane")}>Change Name</button>
      </div>
    );
  }
}
```

Rest оператор часто используется в библиотеках для создания функций высшего порядка, которые принимают переменное количество аргументов. Например, в Lodash есть функции, которые используют Rest оператор для обработки аргументов.

## Ключевые моменты

*   **Spread оператор:** "Распаковывает" элементы итерируемых объектов (массивов, строк).
*   **Rest оператор:** Собирает "остаток" аргументов в массив.
*   Spread используется для копирования массивов и объектов, объединения массивов и передачи аргументов в функции.
*   Rest используется для сбора аргументов функции в массив и деструктуризации.
*   Оба оператора делают код более читаемым и лаконичным.

### Практика

Попробуйте примеры в интерактивном редакторе:

<Sandpack
  template="vanilla"
  files={{
    '/index.js': `// Демонстрация Spread оператора
console.log('=== SPREAD ОПЕРАТОР ===');

// 1. Копирование массива
var originalArray = [1, 2, 3, 4, 5];
var copiedArray = [].concat(originalArray);
console.log('Исходный массив:', originalArray);
console.log('Копия массива:', copiedArray);
console.log('Это разные массивы?', originalArray !== copiedArray);

// 2. Объединение массивов
var fruits = ['apple', 'banana'];
var vegetables = ['carrot', 'tomato'];
var food = [].concat(fruits, vegetables, ['bread']);
console.log('Объединенный массив:', food);

// 3. Копирование объекта
var user = { name: 'John', age: 30 };
var userCopy = Object.assign({}, user, { city: 'Moscow' });
console.log('Копия объекта с новым полем:', userCopy);

console.log('\\n=== REST ОПЕРАТОР ===');

// Функция с Rest параметром
function sum() {
  var numbers = Array.prototype.slice.call(arguments);
  var result = numbers.reduce(function(acc, num) { return acc + num; }, 0);
  console.log('sum(' + numbers.join(', ') + ') = ' + result);
  return result;
}

sum(1, 2, 3);
sum(10, 20, 30, 40);

// UI элементы
var output = document.getElementById('output');
var array1Input = document.getElementById('array1');
var array2Input = document.getElementById('array2');
var mergeBtn = document.getElementById('mergeBtn');
var restInput = document.getElementById('restInput');
var sumBtn = document.getElementById('sumBtn');

// Функция для добавления результата
function addResult(title, content, type) {
  if (!type) { type = 'info'; }
  var div = document.createElement('div');
  div.className = 'result result-' + type;
  div.innerHTML = '<div class="result-title">' + title + '</div>' +
    '<div class="result-content">' + content + '</div>';
  output.appendChild(div);
  output.scrollTop = output.scrollHeight;
}

// Spread: объединение массивов
mergeBtn.addEventListener('click', function() {
  try {
    var arr1 = JSON.parse(array1Input.value);
    var arr2 = JSON.parse(array2Input.value);

    if (!Array.isArray(arr1) || !Array.isArray(arr2)) {
      throw new Error('Оба значения должны быть массивами');
    }

    var merged = [].concat(arr1, arr2);
    console.log('Spread merge:', merged);

    addResult(
      'Spread: Объединение массивов',
      '<code>[...' + JSON.stringify(arr1) + ', ...' + JSON.stringify(arr2) + ']</code><br>' +
      '<strong>Результат:</strong> <code>' + JSON.stringify(merged) + '</code>',
      'success'
    );
  } catch (e) {
    addResult('Ошибка', e.message, 'error');
  }
});

// Rest: сумма чисел
sumBtn.addEventListener('click', function() {
  try {
    var numbers = JSON.parse(restInput.value);

    if (!Array.isArray(numbers)) {
      throw new Error('Введите массив чисел');
    }

    var result = sum.apply(null, numbers);

    addResult(
      'Rest: Сумма чисел',
      '<code>sum(...' + JSON.stringify(numbers) + ')</code><br>' +
      '<strong>Результат:</strong> <code>' + result + '</code><br>' +
      '<small>Функция получила аргументы через rest оператор: <code>function sum(...numbers)</code></small>',
      'success'
    );
  } catch (e) {
    addResult('Ошибка', e.message, 'error');
  }
});

// Примеры деструктуризации
var demoBtn = document.getElementById('demoBtn');
demoBtn.addEventListener('click', function() {
  var arr = [1, 2, 3, 4, 5];
  var first = arr[0];
  var second = arr[1];
  var rest = arr.slice(2);

  console.log('Деструктуризация:', { first: first, second: second, rest: rest });

  addResult(
    'Rest в деструктуризации',
    '<code>const [first, second, ...rest] = ' + JSON.stringify(arr) + '</code><br>' +
    '<strong>first:</strong> ' + first + '<br>' +
    '<strong>second:</strong> ' + second + '<br>' +
    '<strong>rest:</strong> <code>' + JSON.stringify(rest) + '</code>',
    'info'
  );
});

// Начальное сообщение
addResult(
  'Интерактивная демонстрация Spread и Rest',
  'Попробуйте примеры выше! Введите массивы в формате JSON.',
  'info'
);
`,
    '/index.html': `<!DOCTYPE html>
<html>
<head>
  <title>Spread & Rest</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      padding: 20px;
      max-width: 900px;
      margin: 0 auto;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
    }
    h1 {
      color: white;
      text-align: center;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      margin-bottom: 30px;
    }
    .container {
      background: white;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.2);
    }
    .section {
      margin-bottom: 25px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid #667eea;
    }
    .section h3 {
      margin-top: 0;
      color: #667eea;
      font-size: 18px;
    }
    .input-group {
      display: flex;
      gap: 10px;
      margin-top: 12px;
      flex-wrap: wrap;
    }
    input {
      flex: 1;
      padding: 10px;
      border: 2px solid #dee2e6;
      border-radius: 6px;
      font-family: 'Courier New', monospace;
      font-size: 14px;
      min-width: 200px;
    }
    input:focus {
      outline: none;
      border-color: #667eea;
    }
    button {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      background: #667eea;
      color: white;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      transition: all 0.2s;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    button:hover {
      background: #5568d3;
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
    }
    button:active {
      transform: translateY(0);
    }
    #output {
      max-height: 400px;
      overflow-y: auto;
      background: white;
      padding: 15px;
      border-radius: 8px;
      border: 2px solid #dee2e6;
    }
    .result {
      margin-bottom: 12px;
      padding: 12px;
      border-radius: 6px;
      border-left: 4px solid #868e96;
    }
    .result-success {
      background: #d3f9d8;
      border-left-color: #51cf66;
    }
    .result-info {
      background: #e7f5ff;
      border-left-color: #339af0;
    }
    .result-error {
      background: #ffe3e3;
      border-left-color: #ff6b6b;
    }
    .result-title {
      font-weight: bold;
      margin-bottom: 6px;
      font-size: 14px;
    }
    .result-content {
      font-size: 13px;
      line-height: 1.6;
    }
    code {
      background: rgba(0,0,0,0.05);
      padding: 2px 6px;
      border-radius: 3px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
    }
    small {
      color: #666;
    }
    #demoBtn {
      width: 100%;
      background: #f59f00;
      margin-top: 15px;
    }
    #demoBtn:hover {
      background: #e67700;
    }
  </style>
</head>
<body>
  <h1>Spread & Rest Операторы</h1>

  <div class="container">
    <div class="section">
      <h3>Spread: Объединение массивов</h3>
      <div class="input-group">
        <input type="text" id="array1" placeholder="[1, 2, 3]" value="[1, 2, 3]">
        <input type="text" id="array2" placeholder="[4, 5, 6]" value="[4, 5, 6]">
        <button id="mergeBtn">Объединить</button>
      </div>
    </div>

    <div class="section">
      <h3>Rest: Сумма чисел</h3>
      <div class="input-group">
        <input type="text" id="restInput" placeholder="[10, 20, 30, 40]" value="[10, 20, 30, 40]">
        <button id="sumBtn">Вычислить сумму</button>
      </div>
    </div>

    <button id="demoBtn">Демо: Rest в деструктуризации</button>

    <div style="margin-top: 25px;">
      <h3 style="color: #667eea; margin-bottom: 15px;">Результаты:</h3>
      <div id="output"></div>
    </div>
  </div>

  <script src="index.js"></script>
</body>
</html>`
  }}
/>
