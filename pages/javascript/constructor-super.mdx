## JavaScript: Мозги. Урок: constructor и super


![Иллюстрация к уроку](/lessons/javascript-constructor-super.png)
В этом уроке мы разберем важные концепции объектно-ориентированного программирования в JavaScript: конструкторы (constructor) и ключевое слово `super`. Они необходимы для создания и расширения классов, позволяя создавать сложные иерархии объектов.

### Конструктор (constructor)

Конструктор – это специальный метод внутри класса, который вызывается при создании нового экземпляра этого класса с помощью оператора `new`. Он инициализирует свойства объекта. Если конструктор не определен явно, JavaScript создаст конструктор по умолчанию.

```javascript
class Animal {
  constructor(name) {
    this.name = name;
  }

  sayHello() {
    console.log(`Привет, я ${this.name}!`);
  }
}

const animal = new Animal("Барсик");
animal.sayHello(); // Выведет: Привет, я Барсик!
```

В этом примере, `constructor` принимает аргумент `name` и присваивает его свойству `this.name`. `this` ссылается на создаваемый объект.

### Ключевое слово super

Ключевое слово `super` используется внутри дочернего класса для вызова конструктора родительского класса или для доступа к методам родительского класса. Это крайне важно при наследовании.

```javascript
class Dog extends Animal {
  constructor(name, breed) {
    super(name); // Вызываем конструктор родительского класса (Animal)
    this.breed = breed;
  }

  bark() {
    console.log("Гав!");
  }

  sayHello() {
    super.sayHello(); // Вызываем метод sayHello родительского класса
    console.log(`Я породы ${this.breed}.`);
  }
}

const dog = new Dog("Рекс", "Дворняга");
dog.sayHello(); // Выведет: Привет, я Рекс!  Я породы Дворняга.
dog.bark(); // Выведет: Гав!
```

В этом примере, `Dog` наследуется от `Animal`. В конструкторе `Dog` мы вызываем `super(name)` для инициализации свойства `name` из родительского класса.  Также, мы переопределили метод `sayHello`, вызвав родительский метод `super.sayHello()` и добавив свою логику.

### Практический пример кода

Рассмотрим более сложный пример с DOM:

```html
<!DOCTYPE html>
<html>
<head>
  <title>Constructor and Super Example</title>
</head>
<body>
  <div id="container"></div>
  <script>
    class Component {
      constructor(elementId) {
        this.element = document.getElementById(elementId);
      }

      render(content) {
        this.element.innerHTML = content;
      }
    }

    class Button extends Component {
      constructor(elementId, text) {
        super(elementId);
        this.text = text;
      }

      render() {
        super.render(`<button>${this.text}</button>`);
      }
    }

    const button = new Button("container", "Click Me!");
    button.render();
  </script>
</body>
</html>
```

Здесь `Component` – базовый класс для работы с DOM-элементами.  `Button` наследуется от `Component` и добавляет свойство `text` и переопределяет метод `render` для создания кнопки.

### Жизненный пример

Во фреймворке React, `constructor` и `super` активно используются при создании компонентов, особенно классовых.  Компонент может наследовать от `React.Component`, и в его конструкторе необходимо вызвать `super(props)`, чтобы правильно инициализировать компонент и получить доступ к `this.props`.  В Redux, при создании middleware, часто создаются классы, которые расширяют базовые классы или используют паттерны, где `super` играет важную роль в наследовании функциональности.  В Node.js, в модулях для работы с базами данных, например, Mongoose, модели часто создаются как классы, наследующие от базовых классов Mongoose, и `super` используется для инициализации схемы и других параметров модели.

### Ключевые моменты

*   `constructor` - метод для инициализации объекта при создании экземпляра класса.
*   `super()` - вызывает конструктор родительского класса. Необходимо вызывать в конструкторе дочернего класса *до* обращения к `this`.
*   `super.methodName()` - вызывает метод родительского класса.
*   Наследование позволяет создавать иерархии классов и повторно использовать код.
*   `constructor` и `super` – фундаментальные концепции ООП в JavaScript.



## Интерактивный пример

<Sandpack
  template="vanilla"
  files={{
    "/index.html": `<!DOCTYPE html>
<html>
<head>
  <title>Constructor and Super Example</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div id="container">
    <p>Введите имя питомца:</p>
    <input type="text" id="petName" value="Барсик">
    <p>Выберите породу собаки:</p>
    <select id="dogBreed">
      <option value="Дворняга">Дворняга</option>
      <option value="Такса">Такса</option>
      <option value="Овчарка">Овчарка</option>
    </select>
    <button id="createAnimal">Создать животное</button>
    <button id="createDog">Создать собаку</button>
    <div id="output"></div>
  </div>
  <script src="index.js"><\/script>
</body>
</html>`,
    "/styles.css": `body {
  font-family: sans-serif;
  background-color: #282c34;
  color: #fff;
  padding: 20px;
}

#container {
  background-color: #333;
  padding: 20px;
  border-radius: 5px;
}

input[type="text"], select, button {
  padding: 8px;
  margin: 5px;
  border-radius: 3px;
  border: 1px solid #555;
  background-color: #444;
  color: #fff;
}

button {
  cursor: pointer;
  background-color: #61dafb;
  color: #282c34;
  border: none;
}

#output {
  margin-top: 20px;
  padding: 10px;
  border: 1px solid #555;
  border-radius: 5px;
}`,
    "/index.js": `// Класс Animal
class Animal {
  constructor(name) {
    this.name = name;
  }

  sayHello() {
    return \`Привет, я \${'this.name'}!\`;
  }
}

// Класс Dog, наследующийся от Animal
class Dog extends Animal {
  constructor(name, breed) {
    super(name); // Вызов конструктора родительского класса
    this.breed = breed;
  }

  bark() {
    return "Гав!";
  }

  sayHello() {
    return super.sayHello() + \` Я породы \${'this.breed'}.\`; // Вызов метода родительского класса и добавление своей логики
  }
}

// Получаем элементы DOM
const petNameInput = document.getElementById("petName");
const dogBreedSelect = document.getElementById("dogBreed");
const createAnimalButton = document.getElementById("createAnimal");
const createDogButton = document.getElementById("createDog");
const outputDiv = document.getElementById("output");

// Обработчик для создания животного
createAnimalButton.addEventListener("click", () => {
  const name = petNameInput.value;
  const animal = new Animal(name);
  outputDiv.innerHTML = animal.sayHello();
});

// Обработчик для создания собаки
createDogButton.addEventListener("click", () => {
  const name = petNameInput.value;
  const breed = dogBreedSelect.value;
  const dog = new Dog(name, breed);
  outputDiv.innerHTML = dog.sayHello() + "<br>" + dog.bark();
});`
  }}
  options={{
    showNavigator: false,
    showLineNumbers: true,
    editorHeight: 400
  }}
/>
