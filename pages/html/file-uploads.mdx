## HTML: Загрузка файлов


![Иллюстрация к уроку](/lessons/html-file-uploads.png)
В этом уроке мы рассмотрим, как добавить на веб-страницу возможность загрузки файлов с помощью HTML. Эта функциональность позволяет пользователям отправлять файлы (например, изображения, документы) на сервер.

### Концепция загрузки файлов

HTML предоставляет элемент `<input>` с атрибутом `type="file"` для создания поля выбора файла. Когда пользователь выбирает файл, его можно отправить на сервер для дальнейшей обработки (например, сохранения в базе данных или на диске). Важно помнить, что сам HTML не обрабатывает загрузку файлов на сервер. Он лишь предоставляет интерфейс для выбора файла. Обработка загрузки файла на сервере требует использования языков программирования, таких как Python, PHP, Node.js и т.д.

### Пример кода

Вот пример простого поля для загрузки файла:

```html
<!DOCTYPE html>
<html>
<head>
  <title>Загрузка файла</title>
</head>
<body>

  <form action="/upload" method="post" enctype="multipart/form-data">
    <label for="fileUpload">Выберите файл:</label>
    <input type="file" id="fileUpload" name="myFile">
    <button type="submit">Загрузить</button>
  </form>

</body>
</html>
```

Разберем этот код:

*   `<form>`:  Элемент формы, который содержит поле для загрузки файла и кнопку отправки.
    *   `action="/upload"`:  Указывает URL-адрес, на который будут отправлены данные формы (в данном случае, `/upload`). Это должен быть скрипт на стороне сервера, который будет обрабатывать загруженный файл.
    *   `method="post"`:  Указывает метод отправки данных формы. Для загрузки файлов рекомендуется использовать метод `post`.
    *   `enctype="multipart/form-data"`:  Критически важный атрибут для загрузки файлов. Он указывает, как данные формы будут закодированы при отправке. Значение `multipart/form-data` необходимо для правильной отправки файлов.
*   `<input type="file" id="fileUpload" name="myFile">`:  Элемент для выбора файла.
    *   `type="file"`:  Определяет, что это поле для загрузки файла.
    *   `id="fileUpload"`:  Уникальный идентификатор элемента.
    *   `name="myFile"`:  Имя поля, которое будет использоваться на стороне сервера для доступа к загруженному файлу.

### Дополнительные атрибуты

Атрибут `accept` позволяет указать, какие типы файлов пользователь может загружать. Например, чтобы разрешить загрузку только изображений формата JPEG и PNG:

```html
<input type="file" id="fileUpload" name="myFile" accept="image/jpeg, image/png">
```

Атрибут `multiple` позволяет пользователю выбрать несколько файлов для загрузки:

```html
<input type="file" id="fileUpload" name="myFile" multiple>
```

### Жизненный пример

Загрузка файлов используется повсеместно:

*   **Социальные сети:** Загрузка фотографий и видео.
*   **Облачные хранилища:** Загрузка и скачивание файлов.
*   **Системы управления контентом (CMS):** Загрузка изображений для статей, документов и других медиафайлов.
*   **Веб-приложения:** Загрузка аватаров пользователей, отчетов и других документов.
*   **Фреймворки:** Многие JavaScript фреймворки (React, Angular, Vue.js) предоставляют компоненты или библиотеки для упрощения работы с загрузкой файлов, но базовый HTML остается тем же.

### Ключевые моменты

*   Элемент `<input type="file">` создает поле для выбора файла.
*   Атрибут `enctype="multipart/form-data"` необходим для отправки файлов через форму.
*   Атрибут `accept` позволяет ограничить типы файлов, которые можно загрузить.
*   Атрибут `multiple` позволяет пользователю выбрать несколько файлов.
*   Обработка загруженного файла происходит на стороне сервера.
*   `name` атрибут в элементе input необходим для доступа к файлу на стороне сервера.



## Интерактивный пример

<Sandpack
  template="vanilla"
  files={{
    "/index.html": `<!DOCTYPE html>
<html>
<head>
  <title>Загрузка файла</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>

  <div class="container">
    <h1>Загрузка файла</h1>

    <form id="uploadForm" action="/upload" method="post" enctype="multipart/form-data">
      <label for="fileUpload">Выберите файл:</label>
      <input type="file" id="fileUpload" name="myFile" accept="image/*" multiple>
      <button type="submit">Загрузить</button>
    </form>

    <div id="preview">
      <h2>Предварительный просмотр</h2>
      <div id="imagePreview"></div>
    </div>
  </div>

  <script src="/index.js"><\/script>
</body>
</html>`,
    "/styles.css": `body {
  font-family: sans-serif;
  background-color: #222;
  color: #eee;
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: 100vh;
  margin: 0;
}

.container {
  background-color: #333;
  padding: 20px;
  border-radius: 8px;
  width: 500px;
  text-align: center;
}

input[type="file"] {
  margin-bottom: 10px;
  color: #eee;
}

button {
  background-color: #555;
  color: #eee;
  border: none;
  padding: 10px 20px;
  border-radius: 5px;
  cursor: pointer;
}

button:hover {
  background-color: #777;
}

#preview {
  margin-top: 20px;
}

#imagePreview {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
}

#imagePreview img {
  max-width: 100px;
  max-height: 100px;
  margin: 5px;
  border: 1px solid #555;
  border-radius: 5px;
}`,
    "/index.js": `// Получаем ссылку на поле выбора файла
const fileUpload = document.getElementById('fileUpload');
// Получаем ссылку на элемент, где будет отображаться предварительный просмотр
const imagePreview = document.getElementById('imagePreview');

// Добавляем обработчик события изменения значения поля выбора файла
fileUpload.addEventListener('change', function() {
  // Очищаем предыдущий предварительный просмотр
  imagePreview.innerHTML = '';

  // Получаем список выбранных файлов
  const files = fileUpload.files;

  // Перебираем выбранные файлы
  for (let i = 0; i < files.length; i++) {
    const file = files[i];

    // Проверяем, является ли файл изображением
    if (file.type.startsWith('image/')) {
      // Создаем объект FileReader для чтения файла
      const reader = new FileReader();

      // Добавляем обработчик события загрузки файла
      reader.addEventListener('load', function(event) {
        // Создаем элемент <img> для отображения изображения
        const img = document.createElement('img');
        // Устанавливаем атрибут src элемента <img> в base64 представление изображения
        img.src = event.target.result;
        // Добавляем элемент <img> в элемент предварительного просмотра
        imagePreview.appendChild(img);
      });

      // Читаем файл как Data URL (base64 представление)
      reader.readAsDataURL(file);
    } else {
      // Если файл не является изображением, выводим сообщение об ошибке
      const error = document.createElement('p');
      error.textContent = 'Файл ' + file.name + ' не является изображением.';
      imagePreview.appendChild(error);
    }
  }
});

// Добавляем обработчик события отправки формы (для демонстрации, он ничего не делает)
const uploadForm = document.getElementById('uploadForm');
uploadForm.addEventListener('submit', function(event) {
  event.preventDefault(); // Предотвращаем отправку формы
  alert('Форма отправлена (имитация). Файлы не загружаются на сервер в этом примере.');
});`
  }}
  options={{
    showNavigator: false,
    showLineNumbers: true,
    editorHeight: 400
  }}
/>
