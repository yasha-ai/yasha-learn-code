## Git: Git Flow — Строгая Модель Разработки

### Задача: Организовать командную разработку с помощью строгой модели ветвления.

Git Flow — это модель ветвления для Git, предложенная Винсентом Дриссеном. Она предоставляет строгий набор правил для управления проектами, особенно полезных для больших команд и релиз-ориентированной разработки.

### Основные и Поддерживающие Ветви

Git Flow определяет две **основные** долгоживущие ветви:
1.  `main`: Содержит продакшн-готовый код. Каждый коммит здесь — это релиз.
2.  `develop`: Ветвь для интеграции новой функциональности, основа для следующего релиза.

```
main (Production)
  ↑
  └---- develop (Next Release)
```

Также есть **поддерживающие** короткоживущие ветви: `feature`, `release`, `hotfix`.

### 1. `feature` ветви: Разработка новой функциональности.

*   **Откуда**: `develop`
*   **Куда**: `develop`
*   **Имя**: `feature/НАЗВАНИЕ-ФУНКЦИИ`

```bash
# 1. Начать новую фичу
git checkout develop
git pull origin develop
git checkout -b feature/add-user-profile

# ... разработка, коммиты ...

# 2. Завершить фичу (слить в develop)
git checkout develop
git merge --no-ff feature/add-user-profile
git push origin develop
git branch -d feature/add-user-profile
```
*Пояснение*: `--no-ff` создает отдельный мерж-коммит, сохраняя историю фичи.

### 2. `release` ветви: Подготовка к новому релизу.

*   **Откуда**: `develop`
*   **Куда**: `main` и `develop`
*   **Имя**: `release/НОМЕР-ВЕРСИИ`

```bash
# 1. Начать подготовку релиза (например, 1.0.0)
git checkout develop
git checkout -b release/1.0.0

# ... тестирование, исправление багов для релиза ...

# 2. Завершить релиз (слить в main и develop)
git checkout main
git merge --no-ff release/1.0.0
git tag -a v1.0.0 -m "Release version 1.0.0"
git push origin main --tags

git checkout develop
git merge --no-ff release/1.0.0
git push origin develop

git branch -d release/1.0.0
```
*Пояснение*: Релизы в `main` всегда помечаются тегами.

### 3. `hotfix` ветви: Срочные исправления багов в продакшне.

*   **Откуда**: `main`
*   **Куда**: `main` и `develop`
*   **Имя**: `hotfix/НАЗВАНИЕ-ИСПРАВЛЕНИЯ`

```bash
# 1. Начать срочное исправление (например, для v1.0.0)
git checkout main
git checkout -b hotfix/critical-bug-fix

# ... исправление бага ...

# 2. Завершить hotfix (слить в main и develop)
git checkout main
git merge --no-ff hotfix/critical-bug-fix
git tag -a v1.0.1 -m "Hotfix for critical bug"
git push origin main --tags

git checkout develop
git merge --no-ff hotfix/critical-bug-fix
git push origin develop

git branch -d hotfix/critical-bug-fix
```
*Пояснение*: Hotfix'ы сливаются в `develop`, чтобы исправление не пропало в будущем.

### Типичные Проблемы

*   **Сложность**: Избыточен для маленьких команд или проектов с непрерывной доставкой (CD).
*   **Конфликты**: Частые слияния могут приводить к конфликтам.

### Git Best Practices

*   **Используйте расширение `git flow`**: Автоматизирует многие шаги (`git flow feature start`, `git flow feature finish`).
*   **Регулярно синхронизируйтесь**: Pull'те изменения из `develop` перед началом новой фичи.
*   **Маленькие фичи**: Разбивайте задачи, чтобы уменьшить время жизни `feature` ветвей.

### Практика: Разработка новой фичи и подготовка релиза

Представьте, что вам нужно добавить "Отзывы клиентов" и выпустить версию 2.0.0.

```bash
# 1. Начать фичу "Отзывы клиентов"
git checkout develop && git pull origin develop
git checkout -b feature/customer-reviews
echo "Добавлена модель Отзывов" > reviews.txt
git add . && git commit -m "feat: Add customer review model"

# 2. Завершить фичу
git checkout develop
git merge --no-ff feature/customer-reviews
git push origin develop
git branch -d feature/customer-reviews

# 3. Начать релиз 2.0.0
git checkout develop
git checkout -b release/2.0.0
echo "Исправлен баг в отображении отзывов" >> reviews.txt
git add . && git commit -m "fix: Resolve review display bug in release"

# 4. Завершить релиз 2.0.0
git checkout main
git merge --no-ff release/2.0.0
git tag -a v2.0.0 -m "Release version 2.0.0"
git push origin main --tags

git checkout develop
git merge --no-ff release/2.0.0
git push origin develop
git branch -d release/2.0.0
```