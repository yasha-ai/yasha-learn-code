## TypeScript: Union и Intersection типы. Броня против неожиданностей.


![Иллюстрация к уроку](/lessons/typescript-union-intersection.png)
В этом уроке мы разберем два мощных инструмента TypeScript: Union и Intersection типы. Они позволяют создавать более гибкие и точные типы, которые отражают сложность реальных данных.

### Union типы: Или то, или другое.

Union типы позволяют переменной иметь один из нескольких указанных типов.  Иными словами, это тип, который может принимать значения разных типов. Обозначаются они символом `|`.

```typescript
// Переменная может быть либо строкой, либо числом.
let result: string | number;

result = "Hello"; // Ok
result = 123;     // Ok
// result = true;   // Ошибка! Тип boolean не входит в Union тип.
```

Union типы особенно полезны, когда функция может возвращать разные типы в зависимости от условий.

```typescript
function processInput(input: string | number): string {
  if (typeof input === 'string') {
    return input.toUpperCase();
  } else {
    return (input * 2).toString();
  }
}

console.log(processInput("world")); // WORLD
console.log(processInput(5));      // 10
```

TypeScript использует сужение типов (Type Narrowing), чтобы определить, какой тип имеет переменная внутри блока кода. В примере выше, `typeof input === 'string'` позволяет TypeScript понять, что внутри `if` блока `input` является строкой.

### Intersection типы: И то, и другое.

Intersection типы позволяют объединять несколько типов в один.  Это значит, что переменная должна соответствовать *всем* указанным типам одновременно. Обозначаются они символом `&`.

```typescript
interface Colorful {
  color: string;
}

interface Circle {
  radius: number;
}

// Тип ColoredCircle должен иметь и color, и radius.
type ColoredCircle = Colorful & Circle;

const coloredCircle: ColoredCircle = {
  color: "red",
  radius: 10,
};

console.log(coloredCircle.color); // red
console.log(coloredCircle.radius); // 10
```

Intersection типы часто используются для расширения интерфейсов или типов, добавляя новые свойства.

```typescript
interface Person {
  name: string;
  age: number;
}

interface Address {
  street: string;
  city: string;
}

// Employee должен иметь все свойства Person и Address.
type Employee = Person & Address;

const employee: Employee = {
  name: "John Doe",
  age: 30,
  street: "123 Main St",
  city: "Anytown",
};

console.log(employee.name);  // John Doe
console.log(employee.city);  // Anytown
```

### Жизненный пример

В React часто используются Intersection типы для создания типов props для компонентов, которые принимают различные наборы свойств. Например, компонент может принимать общие свойства и специфические свойства в зависимости от его конфигурации.

```typescript
interface BaseProps {
  className?: string;
}

interface ButtonProps {
  onClick: () => void;
  label: string;
}

interface LinkProps {
  href: string;
}

// Компонент может быть либо кнопкой, либо ссылкой.
type MyComponentProps = BaseProps & (ButtonProps | LinkProps);

function MyComponent(props: MyComponentProps) {
  // ... Логика компонента.
  return null; // Заглушка
}
```

В Redux, Intersection типы могут использоваться для объединения типов состояния (state) разных редьюсеров.

### Ключевые моменты

*   **Union типы (`|`)** позволяют переменной иметь один из нескольких указанных типов.
*   **Intersection типы (`&`)** позволяют объединять несколько типов в один, требуя наличия всех свойств.
*   TypeScript использует **сужение типов** для определения типа переменной внутри блоков кода.
*   Union и Intersection типы помогают создавать более **гибкие и точные типы**, отражающие сложность реальных данных.
*   Оба типа широко применяются в популярных фреймворках и библиотеках, таких как **React и Redux**.



## Интерактивный пример

<Playground
  template="vanilla-ts"
  files={{
    "/index.html": `
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TypeScript Union & Intersection</title>
    <style>
        body { background-color: #282c34; color: white; font-family: sans-serif; display: flex; flex-direction: column; align-items: center; }
        button { padding: 10px 20px; margin: 10px; cursor: pointer; background-color: #61dafb; border: none; border-radius: 5px; color: black; }
        #output { margin-top: 20px; }
    <\/style>
</head>
<body>
    <h1>Union & Intersection Types</h1>
    <button id="unionButton">Union Example</button>
    <button id="intersectionButton">Intersection Example</button>
    <div id="output"></div>

    <script>
        const unionButton = document.getElementById('unionButton');
        const intersectionButton = document.getElementById('intersectionButton');
        const outputDiv = document.getElementById('output');

        unionButton.addEventListener('click', () => {
            let result: string | number;
            result = Math.random() > 0.5 ? "Hello" : 123;
            outputDiv.textContent = "Union Result: " + result.toString();
        });

        intersectionButton.addEventListener('click', () => {
            interface Colorful { color: string; }
            interface Circle { radius: number; }
            type ColoredCircle = Colorful & Circle;

            const coloredCircle: ColoredCircle = { color: "blue", radius: 5 };
            outputDiv.textContent = "Intersection Result: Color: " + coloredCircle.color + ", Radius: " + coloredCircle.radius;
        });
    <\/script>
</body>
</html>
`
  }}
/>
