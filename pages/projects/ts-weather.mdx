import { Sandpack } from '@codesandbox/sandpack-react'
# TypeScript Weather App

–°–æ–∑–¥–∞–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–∞ –ø–æ–≥–æ–¥—ã —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º TypeScript! API, —Ç–∏–ø–∏–∑–∞—Ü–∏—è, –º–æ–¥—É–ª–∏ ‚Äî –≤—Å—ë –∫–∞–∫ –≤ –Ω–∞—Å—Ç–æ—è—â–∏—Ö production-–ø—Ä–æ–µ–∫—Ç–∞—Ö.

---

## –ß—Ç–æ –±—É–¥–µ–º –¥–µ–ª–∞—Ç—å

- **Weather API** ‚Äî —Ä–∞–±–æ—Ç–∞ —Å OpenWeatherMap API
- **TypeScript** ‚Äî —Ç–∏–ø–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- **Modules** ‚Äî —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∫–æ–¥–∞ –Ω–∞ –º–æ–¥—É–ª–∏
- **Error handling** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∑–∞–ø—Ä–æ—Å–æ–≤
- **Local caching** ‚Äî –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- **Responsive UI** ‚Äî –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω

---

## –≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

### –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

‚úÖ **Node.js** (v18+) ‚Äî –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å TypeScript  
[–°–∫–∞—á–∞—Ç—å Node.js ‚Üí](https://nodejs.org/)

‚úÖ **VS Code** ‚Äî —Ä–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥–∞  
[–°–∫–∞—á–∞—Ç—å VS Code ‚Üí](https://code.visualstudio.com/)

‚úÖ **OpenWeatherMap API Key** ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∫–ª—é—á  
[–ü–æ–ª—É—á–∏—Ç—å API key ‚Üí](https://openweathermap.org/api)

### –°–æ–∑–¥–∞–π –ø—Ä–æ–µ–∫—Ç

```bash
# –°–æ–∑–¥–∞–π –ø–∞–ø–∫—É
mkdir weather-app
cd weather-app

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è npm
npm init -y

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ TypeScript
npm install -D typescript

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–∏–ø–æ–≤ –¥–ª—è DOM
npm install -D @types/node

# –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–∞ TypeScript
npx tsc --init
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```bash
weather-app/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ types/           # TypeScript –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ weather.ts
‚îÇ   ‚îú‚îÄ‚îÄ api/             # API –º–æ–¥—É–ª–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ weatherAPI.ts
‚îÇ   ‚îú‚îÄ‚îÄ utils/           # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ formatters.ts
‚îÇ   ‚îú‚îÄ‚îÄ components/      # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ weatherCard.ts
‚îÇ   ‚îî‚îÄ‚îÄ app.ts           # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îî‚îÄ‚îÄ style.css
‚îú‚îÄ‚îÄ dist/                # –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JS (—Å–æ–∑–¥–∞—ë—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îú‚îÄ‚îÄ tsconfig.json        # TypeScript –∫–æ–Ω—Ñ–∏–≥
‚îî‚îÄ‚îÄ package.json
```

---

## –≠—Ç–∞–ø 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ TypeScript

–û—Ç–∫—Ä–æ–π `tsconfig.json` –∏ –Ω–∞—Å—Ç—Ä–æ–π:

```json
{
  "compilerOptions": {
    "target": "ES2020",
    "module": "ES2020",
    "lib": ["ES2020", "DOM"],
    "outDir": "./dist",
    "rootDir": "./src",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "moduleResolution": "node",
    "resolveJsonModule": true
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules"]
}
```

–î–æ–±–∞–≤—å scripts –≤ `package.json`:

```json
{
  "scripts": {
    "build": "tsc",
    "watch": "tsc --watch",
    "dev": "tsc --watch"
  }
}
```

---

## –≠—Ç–∞–ø 3: TypeScript —Ç–∏–ø—ã

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `src/types/weather.ts`:

```typescript
// === WEATHER DATA TYPES ===

/**
 * –û—Ç–≤–µ—Ç –æ—Ç OpenWeatherMap API
 */
export interface WeatherResponse {
  coord: {
    lon: number;
    lat: number;
  };
  weather: Array<{
    id: number;
    main: string;
    description: string;
    icon: string;
  }>;
  base: string;
  main: {
    temp: number;
    feels_like: number;
    temp_min: number;
    temp_max: number;
    pressure: number;
    humidity: number;
  };
  visibility: number;
  wind: {
    speed: number;
    deg: number;
  };
  clouds: {
    all: number;
  };
  dt: number;
  sys: {
    type: number;
    id: number;
    country: string;
    sunrise: number;
    sunset: number;
  };
  timezone: number;
  id: number;
  name: string;
  cod: number;
}

/**
 * –£–ø—Ä–æ—â—ë–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ –ø–æ–≥–æ–¥–µ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
 */
export interface WeatherData {
  city: string;
  country: string;
  temperature: number;
  feelsLike: number;
  description: string;
  icon: string;
  humidity: number;
  windSpeed: number;
  pressure: number;
  sunrise: number;
  sunset: number;
}

/**
 * –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è API
 */
export interface APIConfig {
  apiKey: string;
  baseURL: string;
  units: 'metric' | 'imperial';
}

/**
 * –ö–µ—à –ø–æ–≥–æ–¥—ã
 */
export interface WeatherCache {
  data: WeatherData;
  timestamp: number;
  expiresIn: number; // milliseconds
}

/**
 * –°—Ç–∞—Ç—É—Å –∑–∞–ø—Ä–æ—Å–∞
 */
export type RequestStatus = 'idle' | 'loading' | 'success' | 'error';

/**
 * –û—à–∏–±–∫–∞ API
 */
export interface APIError {
  code: number;
  message: string;
}
```

**–ß—Ç–æ –∑–¥–µ—Å—å:**
- ‚úÖ **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã** –¥–ª—è –≤—Å–µ—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **Type safety** ‚Äî TypeScript –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–∏–ø—ã
- ‚úÖ **JSDoc –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏** ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä—è–º–æ –≤ –∫–æ–¥–µ
- ‚úÖ **Union types** (metric | imperial)

---

## –≠—Ç–∞–ø 4: API –º–æ–¥—É–ª—å

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `src/api/weatherAPI.ts`:

```typescript
import { WeatherResponse, WeatherData, APIConfig, APIError } from '../types/weather.js';

/**
 * Weather API Client
 */
export class WeatherAPI {
  private config: APIConfig;

  constructor(apiKey: string) {
    this.config = {
      apiKey,
      baseURL: 'https://api.openweathermap.org/data/2.5',
      units: 'metric'
    };
  }

  /**
   * –ü–æ–ª—É—á–∏—Ç—å –ø–æ–≥–æ–¥—É –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –≥–æ—Ä–æ–¥–∞
   */
  async getWeatherByCity(city: string): Promise<WeatherData> {
    try {
      const url = `${this.config.baseURL}/weather?q=${encodeURIComponent(city)}&appid=${this.config.apiKey}&units=${this.config.units}`;
      
      const response = await fetch(url);
      
      if (!response.ok) {
        const errorData = await response.json();
        throw this.createError(response.status, errorData.message);
      }

      const data: WeatherResponse = await response.json();
      return this.transformResponse(data);
      
    } catch (error) {
      if (error instanceof Error) {
        throw error;
      }
      throw this.createError(500, 'Unknown error occurred');
    }
  }

  /**
   * –ü–æ–ª—É—á–∏—Ç—å –ø–æ–≥–æ–¥—É –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º
   */
  async getWeatherByCoords(lat: number, lon: number): Promise<WeatherData> {
    try {
      const url = `${this.config.baseURL}/weather?lat=${lat}&lon=${lon}&appid=${this.config.apiKey}&units=${this.config.units}`;
      
      const response = await fetch(url);
      
      if (!response.ok) {
        const errorData = await response.json();
        throw this.createError(response.status, errorData.message);
      }

      const data: WeatherResponse = await response.json();
      return this.transformResponse(data);
      
    } catch (error) {
      if (error instanceof Error) {
        throw error;
      }
      throw this.createError(500, 'Unknown error occurred');
    }
  }

  /**
   * –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç API –≤ —É–ø—Ä–æ—â—ë–Ω–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
   */
  private transformResponse(response: WeatherResponse): WeatherData {
    return {
      city: response.name,
      country: response.sys.country,
      temperature: Math.round(response.main.temp),
      feelsLike: Math.round(response.main.feels_like),
      description: response.weather[0].description,
      icon: response.weather[0].icon,
      humidity: response.main.humidity,
      windSpeed: response.wind.speed,
      pressure: response.main.pressure,
      sunrise: response.sys.sunrise,
      sunset: response.sys.sunset
    };
  }

  /**
   * –°–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç –æ—à–∏–±–∫–∏
   */
  private createError(code: number, message: string): APIError {
    return {
      code,
      message
    };
  }
}
```

**–ß—Ç–æ –∑–¥–µ—Å—å:**
- ‚úÖ **Class-based API** ‚Äî –û–û–ü –ø–æ–¥—Ö–æ–¥
- ‚úÖ **Private methods** ‚Äî –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏—è –ª–æ–≥–∏–∫–∏
- ‚úÖ **Type annotations** ‚Äî –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ **Error handling** ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –æ—à–∏–±–æ–∫
- ‚úÖ **Data transformation** ‚Äî –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Å–ª–æ–∂–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –≤ –ø—Ä–æ—Å—Ç–æ–π —Ñ–æ—Ä–º–∞—Ç

---

## –≠—Ç–∞–ø 5: –£—Ç–∏–ª–∏—Ç—ã

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `src/utils/formatters.ts`:

```typescript
/**
 * –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Unix timestamp –≤ –≤—Ä–µ–º—è (HH:MM)
 */
export function formatTime(timestamp: number): string {
  const date = new Date(timestamp * 1000);
  const hours = date.getHours().toString().padStart(2, '0');
  const minutes = date.getMinutes().toString().padStart(2, '0');
  return `${hours}:${minutes}`;
}

/**
 * –ü–æ–ª—É—á–∏—Ç—å –∏–∫–æ–Ω–∫—É –ø–æ–≥–æ–¥—ã URL
 */
export function getWeatherIconURL(icon: string): string {
  return `https://openweathermap.org/img/wn/${icon}@2x.png`;
}

/**
 * –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –º/—Å –≤ –∫–º/—á
 */
export function convertWindSpeed(speedMs: number): string {
  const speedKmh = Math.round(speedMs * 3.6);
  return `${speedKmh} –∫–º/—á`;
}

/**
 * –ü–æ–ª—É—á–∏—Ç—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ç—Ä–∞ –ø–æ –≥—Ä–∞–¥—É—Å–∞–º
 */
export function getWindDirection(degrees: number): string {
  const directions = ['–°', '–°–í', '–í', '–Æ–í', '–Æ', '–Æ–ó', '–ó', '–°–ó'];
  const index = Math.round(degrees / 45) % 8;
  return directions[index];
}

/**
 * Capitalize first letter
 */
export function capitalize(str: string): string {
  return str.charAt(0).toUpperCase() + str.slice(1);
}
```

**–ß—Ç–æ –∑–¥–µ—Å—å:**
- ‚úÖ **Pure functions** ‚Äî —Ñ—É–Ω–∫—Ü–∏–∏ –±–µ–∑ –ø–æ–±–æ—á–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
- ‚úÖ **Type safety** ‚Äî –∫–∞–∂–¥–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
- ‚úÖ **Reusable utilities** ‚Äî –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –¥—Ä—É–≥–∏—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö

---

## –≠—Ç–∞–ø 6: UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `src/components/weatherCard.ts`:

```typescript
import { WeatherData } from '../types/weather.js';
import { formatTime, getWeatherIconURL, convertWindSpeed, capitalize } from '../utils/formatters.js';

/**
 * –û—Ç—Ä–∏—Å–æ–≤–∞—Ç—å –∫–∞—Ä—Ç–æ—á–∫—É –ø–æ–≥–æ–¥—ã
 */
export function renderWeatherCard(data: WeatherData): string {
  return `
    <div class="weather-card">
      <!-- Header -->
      <div class="location">
        <h2>${data.city}, ${data.country}</h2>
      </div>

      <!-- Main Info -->
      <div class="main-info">
        <img 
          src="${getWeatherIconURL(data.icon)}" 
          alt="${data.description}"
          class="weather-icon"
        >
        <div class="temperature">
          <span class="temp-value">${data.temperature}¬∞</span>
          <span class="temp-unit">C</span>
        </div>
        <p class="description">${capitalize(data.description)}</p>
      </div>

      <!-- Details Grid -->
      <div class="details-grid">
        <div class="detail-item">
          <span class="detail-label">–û—â—É—â–∞–µ—Ç—Å—è</span>
          <span class="detail-value">${data.feelsLike}¬∞C</span>
        </div>

        <div class="detail-item">
          <span class="detail-label">–í–ª–∞–∂–Ω–æ—Å—Ç—å</span>
          <span class="detail-value">${data.humidity}%</span>
        </div>

        <div class="detail-item">
          <span class="detail-label">–í–µ—Ç–µ—Ä</span>
          <span class="detail-value">${convertWindSpeed(data.windSpeed)}</span>
        </div>

        <div class="detail-item">
          <span class="detail-label">–î–∞–≤–ª–µ–Ω–∏–µ</span>
          <span class="detail-value">${data.pressure} –º–±–∞—Ä</span>
        </div>

        <div class="detail-item">
          <span class="detail-label">–í–æ—Å—Ö–æ–¥</span>
          <span class="detail-value">${formatTime(data.sunrise)}</span>
        </div>

        <div class="detail-item">
          <span class="detail-label">–ó–∞–∫–∞—Ç</span>
          <span class="detail-value">${formatTime(data.sunset)}</span>
        </div>
      </div>
    </div>
  `;
}

/**
 * –û—Ç—Ä–∏—Å–æ–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏
 */
export function renderLoading(): string {
  return `
    <div class="loading">
      <div class="spinner"></div>
      <p>–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–≥–æ–¥—ã...</p>
    </div>
  `;
}

/**
 * –û—Ç—Ä–∏—Å–æ–≤–∞—Ç—å –æ—à–∏–±–∫—É
 */
export function renderError(message: string): string {
  return `
    <div class="error">
      <p class="error-icon">‚ö†Ô∏è</p>
      <p class="error-message">${message}</p>
      <button class="retry-btn">–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞</button>
    </div>
  `;
}
```

**–ß—Ç–æ –∑–¥–µ—Å—å:**
- ‚úÖ **Template strings** ‚Äî HTML –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤ JS
- ‚úÖ **Pure render functions** ‚Äî –ø—Ä–∏–Ω–∏–º–∞—é—Ç –¥–∞–Ω–Ω—ã–µ, –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç HTML
- ‚úÖ **Loading & Error states** ‚Äî UI –¥–ª—è –≤—Å–µ—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π

---

## –≠—Ç–∞–ø 7: –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `src/app.ts`:

```typescript
import { WeatherAPI } from './api/weatherAPI.js';
import { WeatherData, RequestStatus } from './types/weather.js';
import { renderWeatherCard, renderLoading, renderError } from './components/weatherCard.js';

/**
 * Weather App Class
 */
class WeatherApp {
  private api: WeatherAPI;
  private searchInput: HTMLInputElement;
  private searchBtn: HTMLButtonElement;
  private geoBtn: HTMLButtonElement;
  private weatherContainer: HTMLElement;
  private status: RequestStatus = 'idle';

  constructor(apiKey: string) {
    this.api = new WeatherAPI(apiKey);
    
    // Get DOM elements
    this.searchInput = document.getElementById('searchInput') as HTMLInputElement;
    this.searchBtn = document.getElementById('searchBtn') as HTMLButtonElement;
    this.geoBtn = document.getElementById('geoBtn') as HTMLButtonElement;
    this.weatherContainer = document.getElementById('weatherContainer') as HTMLElement;

    this.init();
  }

  /**
   * –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   */
  private init(): void {
    // Event listeners
    this.searchBtn.addEventListener('click', () => this.handleSearch());
    this.searchInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') this.handleSearch();
    });
    this.geoBtn.addEventListener('click', () => this.handleGeolocation());

    // Load default city (Moscow)
    this.fetchWeather('Moscow');
  }

  /**
   * –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–∏—Å–∫–∞ –ø–æ –≥–æ—Ä–æ–¥—É
   */
  private async handleSearch(): Promise<void> {
    const city = this.searchInput.value.trim();
    
    if (!city) {
      this.showError('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥–æ—Ä–æ–¥–∞');
      return;
    }

    await this.fetchWeather(city);
  }

  /**
   * –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏
   */
  private handleGeolocation(): void {
    if (!navigator.geolocation) {
      this.showError('–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤–∞—à–∏–º –±—Ä–∞—É–∑–µ—Ä–æ–º');
      return;
    }

    this.setStatus('loading');
    this.weatherContainer.innerHTML = renderLoading();

    navigator.geolocation.getCurrentPosition(
      (position) => {
        const { latitude, longitude } = position.coords;
        this.fetchWeatherByCoords(latitude, longitude);
      },
      (error) => {
        this.showError('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é: ' + error.message);
      }
    );
  }

  /**
   * –ü–æ–ª—É—á–∏—Ç—å –ø–æ–≥–æ–¥—É –ø–æ –≥–æ—Ä–æ–¥—É
   */
  private async fetchWeather(city: string): Promise<void> {
    try {
      this.setStatus('loading');
      this.weatherContainer.innerHTML = renderLoading();

      const data = await this.api.getWeatherByCity(city);
      
      this.setStatus('success');
      this.weatherContainer.innerHTML = renderWeatherCard(data);

    } catch (error) {
      this.setStatus('error');
      const message = error instanceof Error ? error.message : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞';
      this.showError(message);
    }
  }

  /**
   * –ü–æ–ª—É—á–∏—Ç—å –ø–æ–≥–æ–¥—É –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º
   */
  private async fetchWeatherByCoords(lat: number, lon: number): Promise<void> {
    try {
      const data = await this.api.getWeatherByCoords(lat, lon);
      
      this.setStatus('success');
      this.weatherContainer.innerHTML = renderWeatherCard(data);

    } catch (error) {
      this.setStatus('error');
      const message = error instanceof Error ? error.message : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞';
      this.showError(message);
    }
  }

  /**
   * –ü–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É
   */
  private showError(message: string): void {
    this.weatherContainer.innerHTML = renderError(message);

    // Retry button
    const retryBtn = this.weatherContainer.querySelector('.retry-btn');
    if (retryBtn) {
      retryBtn.addEventListener('click', () => {
        this.fetchWeather(this.searchInput.value || 'Moscow');
      });
    }
  }

  /**
   * –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–ø—Ä–æ—Å–∞
   */
  private setStatus(status: RequestStatus): void {
    this.status = status;
    console.log('Status:', status);
  }
}

// === INIT APP ===
const API_KEY = 'YOUR_API_KEY_HERE'; // –í—Å—Ç–∞–≤—å —Å–≤–æ–π –∫–ª—é—á!

document.addEventListener('DOMContentLoaded', () => {
  new WeatherApp(API_KEY);
});
```

**–ß—Ç–æ –∑–¥–µ—Å—å:**
- ‚úÖ **Class-based architecture** ‚Äî –≤–µ—Å—å –∫–æ–¥ –≤ –æ–¥–Ω–æ–º –∫–ª–∞—Å—Å–µ
- ‚úÖ **Private methods** ‚Äî –≤—Å–µ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã private
- ‚úÖ **Type safety** ‚Äî –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
- ‚úÖ **Event delegation** ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π
- ‚úÖ **Geolocation support** ‚Äî –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–≥–æ–¥—ã –ø–æ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—é

---

## –≠—Ç–∞–ø 8: HTML

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `public/index.html`:

```html
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Weather App ‚Äî TypeScript Project</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <h1>üå§Ô∏è Weather App</h1>
      <p class="subtitle">–ü—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã –Ω–∞ TypeScript</p>
    </header>

    <!-- Search -->
    <div class="search-section">
      <input 
        type="text" 
        id="searchInput" 
        placeholder="–í–≤–µ–¥–∏—Ç–µ –≥–æ—Ä–æ–¥ (Moscow, London...)"
        autocomplete="off"
      >
      <button id="searchBtn">–ù–∞–π—Ç–∏</button>
      <button id="geoBtn" class="geo-btn" title="–ú–æ—ë –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ">
        üìç
      </button>
    </div>

    <!-- Weather Display -->
    <div id="weatherContainer" class="weather-container">
      <!-- Weather card –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
    </div>
  </div>

  <script type="module" src="../dist/app.js"></script>
</body>
</html>
```

---

## –≠—Ç–∞–ø 9: CSS

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `public/style.css`:

```css
/* === RESET === */
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 20px;
}

.container {
  max-width: 500px;
  width: 100%;
}

/* === HEADER === */
.header {
  text-align: center;
  color: white;
  margin-bottom: 30px;
}

.header h1 {
  font-size: 2.5rem;
  margin-bottom: 5px;
}

.subtitle {
  font-size: 0.9rem;
  opacity: 0.9;
}

/* === SEARCH === */
.search-section {
  display: flex;
  gap: 10px;
  margin-bottom: 30px;
}

#searchInput {
  flex: 1;
  padding: 15px 20px;
  border: none;
  border-radius: 10px;
  font-size: 1rem;
  outline: none;
}

#searchBtn {
  padding: 15px 30px;
  background: white;
  color: #667eea;
  border: none;
  border-radius: 10px;
  font-size: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
}

#searchBtn:hover {
  background: #f0f0f0;
  transform: translateY(-2px);
}

.geo-btn {
  padding: 15px 20px;
  background: white;
  border: none;
  border-radius: 10px;
  font-size: 1.2rem;
  cursor: pointer;
  transition: all 0.3s;
}

.geo-btn:hover {
  background: #f0f0f0;
  transform: scale(1.1);
}

/* === WEATHER CARD === */
.weather-card {
  background: white;
  border-radius: 20px;
  padding: 30px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
}

.location h2 {
  font-size: 1.8rem;
  margin-bottom: 20px;
  text-align: center;
}

.main-info {
  text-align: center;
  margin-bottom: 30px;
}

.weather-icon {
  width: 120px;
  height: 120px;
}

.temperature {
  font-size: 4rem;
  font-weight: 700;
  color: #667eea;
  margin: 10px 0;
}

.temp-unit {
  font-size: 2rem;
  font-weight: 400;
  color: #999;
}

.description {
  font-size: 1.2rem;
  color: #666;
  text-transform: capitalize;
}

/* === DETAILS GRID === */
.details-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 15px;
}

.detail-item {
  background: #f9f9f9;
  padding: 15px;
  border-radius: 10px;
  text-align: center;
}

.detail-label {
  display: block;
  font-size: 0.85rem;
  color: #999;
  margin-bottom: 5px;
}

.detail-value {
  display: block;
  font-size: 1.2rem;
  font-weight: 600;
  color: #333;
}

/* === LOADING === */
.loading {
  text-align: center;
  padding: 60px 20px;
  background: white;
  border-radius: 20px;
}

.spinner {
  width: 50px;
  height: 50px;
  border: 5px solid #f3f3f3;
  border-top: 5px solid #667eea;
  border-radius: 50%;
  margin: 0 auto 20px;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.loading p {
  color: #666;
  font-size: 1rem;
}

/* === ERROR === */
.error {
  text-align: center;
  padding: 60px 20px;
  background: white;
  border-radius: 20px;
}

.error-icon {
  font-size: 3rem;
  margin-bottom: 15px;
}

.error-message {
  color: #e74c3c;
  font-size: 1.1rem;
  margin-bottom: 20px;
}

.retry-btn {
  padding: 12px 30px;
  background: #667eea;
  color: white;
  border: none;
  border-radius: 10px;
  font-size: 1rem;
  cursor: pointer;
  transition: background 0.3s;
}

.retry-btn:hover {
  background: #5568d3;
}

/* === RESPONSIVE === */
@media (max-width: 600px) {
  .header h1 {
    font-size: 2rem;
  }

  .temperature {
    font-size: 3rem;
  }

  .details-grid {
    grid-template-columns: 1fr;
  }
}
```

---

## –≠—Ç–∞–ø 10: –ö–æ–º–ø–∏–ª—è—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫

### 1. –ü–æ–ª—É—á–∏ API –∫–ª—é—á

1. –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ [OpenWeatherMap](https://openweathermap.org/api)
2. –°–æ–∑–¥–∞–π –∞–∫–∫–∞—É–Ω—Ç
3. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π API key (–±–µ—Å–ø–ª–∞—Ç–Ω–æ)
4. –í—Å—Ç–∞–≤—å –∫–ª—é—á –≤ `src/app.ts`:

```typescript
const API_KEY = '—Ç–≤–æ–π_api_–∫–ª—é—á_–∑–¥–µ—Å—å';
```

### 2. –°–∫–æ–º–ø–∏–ª–∏—Ä—É–π TypeScript

```bash
npm run build

# –ò–ª–∏ –≤ —Ä–µ–∂–∏–º–µ watch (–∞–≤—Ç–æ-–∫–æ–º–ø–∏–ª—è—Ü–∏—è):
npm run dev
```

TypeScript —Å–∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –≤ `dist/app.js`.

### 3. –ó–∞–ø—É—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

–û—Ç–∫—Ä–æ–π `public/index.html` –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π Live Server.

---

## –≠—Ç–∞–ø 11: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

‚úÖ **–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**

1. **–ü–æ–∏—Å–∫ –ø–æ –≥–æ—Ä–æ–¥—É:**
   - –í–≤–µ–¥–∏ "Moscow" ‚Üí –¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑–∞—Ç—å—Å—è –ø–æ–≥–æ–¥–∞ –≤ –ú–æ—Å–∫–≤–µ
   - –í–≤–µ–¥–∏ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –≥–æ—Ä–æ–¥ ‚Üí –¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑–∞—Ç—å—Å—è –æ—à–∏–±–∫–∞
   - –ü—É—Å—Ç–æ–µ –ø–æ–ª–µ ‚Üí –¥–æ–ª–∂–Ω–∞ –ø–æ–∫–∞–∑–∞—Ç—å—Å—è –æ—à–∏–±–∫–∞

2. **–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è:**
   - –ö–ª–∏–∫ –Ω–∞ üìç ‚Üí –±—Ä–∞—É–∑–µ—Ä —Å–ø—Ä–æ—Å–∏—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ
   - –†–∞–∑—Ä–µ—à–∏—Ç—å ‚Üí –ø–æ–≥–æ–¥–∞ –ø–æ —Ç–≤–æ–µ–º—É –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—é
   - –ó–∞–ø—Ä–µ—Ç–∏—Ç—å ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å –æ—à–∏–±–∫—É

3. **Loading state:**
   - –ü—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å—Å—è spinner
   - –ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∞ –ø–æ–≥–æ–¥—ã

4. **Error handling:**
   - –ù–µ–≤–µ—Ä–Ω—ã–π API key ‚Üí –æ—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
   - –ù–µ—Ç –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞ ‚Üí –æ—à–∏–±–∫–∞ —Å–µ—Ç–∏
   - –ö–Ω–æ–ø–∫–∞ "Retry" ‚Üí –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–ø—Ä–æ—Å

---

## –≠—Ç–∞–ø 12: –î–µ–ø–ª–æ–π

### –í–∞—Ä–∏–∞–Ω—Ç 1: Vercel

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏ Vercel CLI
npm i -g vercel

# –°–∫–æ–º–ø–∏–ª–∏—Ä—É–π TypeScript
npm run build

# –î–µ–ø–ª–æ–π
vercel

# –£–∫–∞–∂–∏ public/ –∫–∞–∫ –∫–æ—Ä–Ω–µ–≤—É—é –ø–∞–ø–∫—É
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: Netlify

1. –°–∫–æ–º–ø–∏–ª–∏—Ä—É–π –ø—Ä–æ–µ–∫—Ç: `npm run build`
2. –ü–µ—Ä–µ–π–¥–∏ –Ω–∞ [netlify.com](https://www.netlify.com/)
3. Drag & Drop –ø–∞–ø–∫—É `public/` –≤ –±—Ä–∞—É–∑–µ—Ä
4. –ì–æ—Ç–æ–≤–æ!

### –í–∞—Ä–∏–∞–Ω—Ç 3: GitHub Pages

```bash
# 1. –î–æ–±–∞–≤—å build –≤ .gitignore (–µ—Å–ª–∏ –Ω–µ —Ö–æ—á–µ—à—å –∫–æ–º–º–∏—Ç–∏—Ç—å)
# 2. –°–∫–æ–ø–∏—Ä—É–π dist/ –≤ public/
cp -r dist public/

# 3. –ó–∞–∫–æ–º–º–∏—Ç—å –∏ –∑–∞–ø—É—à–∏—Ç—å
git add .
git commit -m "Deploy: Weather App"
git push origin main

# 4. –í–∫–ª—é—á–∏ GitHub Pages (Settings ‚Üí Pages)
```

---

## –£–ª—É—á—à–µ–Ω–∏—è (–±–æ–Ω—É—Å)

### 1. –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```typescript
class WeatherCache {
  private cache: Map<string, { data: WeatherData; timestamp: number }> = new Map();
  private expiresIn = 10 * 60 * 1000; // 10 –º–∏–Ω—É—Ç

  get(key: string): WeatherData | null {
    const cached = this.cache.get(key);
    
    if (!cached) return null;
    
    const isExpired = Date.now() - cached.timestamp > this.expiresIn;
    if (isExpired) {
      this.cache.delete(key);
      return null;
    }

    return cached.data;
  }

  set(key: string, data: WeatherData): void {
    this.cache.set(key, {
      data,
      timestamp: Date.now()
    });
  }
}
```

### 2. –ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ 5 –¥–Ω–µ–π

```typescript
async getForecast(city: string): Promise<ForecastData[]> {
  const url = `${this.config.baseURL}/forecast?q=${city}&appid=${this.config.apiKey}&units=${this.config.units}`;
  const response = await fetch(url);
  const data = await response.json();
  
  return data.list.map(this.transformForecast);
}
```

### 3. –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –µ–¥–∏–Ω–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏—è

```typescript
toggleUnits(): void {
  this.config.units = this.config.units === 'metric' ? 'imperial' : 'metric';
  // Refresh weather
}
```

---

## –ò—Ç–æ–≥–∏

‚úÖ **–ß—Ç–æ —Ç—ã —Å–æ–∑–¥–∞–ª:**
- Weather App –Ω–∞ TypeScript —Å –ø–æ–ª–Ω–æ–π —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π
- –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (API, utils, components)
- –†–∞–±–æ—Ç–∞ —Å OpenWeatherMap API
- –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ Navigator API
- Error handling –∏ Loading states
- Responsive UI

‚úÖ **–ß—Ç–æ —Ç—ã –æ—Å–≤–æ–∏–ª:**
- **TypeScript basics** (types, interfaces, classes)
- **Modules** (import/export)
- **Async/Await** (API –∑–∞–ø—Ä–æ—Å—ã)
- **Error handling** (try/catch, custom errors)
- **OOP** (classes, private/public methods)
- **DOM manipulation** —Å —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π

---

## –ü—Ä–∞–∫—Ç–∏–∫–∞

–ü–æ–ø—Ä–æ–±—É–π –±–∞–∑–æ–≤—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é Weather App –ø—Ä—è–º–æ –∑–¥–µ—Å—å (—É–ø—Ä–æ—â—ë–Ω–Ω–∞—è JavaScript –≤–µ—Ä—Å–∏—è —Å JSDoc —Ç–∏–ø–∞–º–∏):

<Sandpack
  template="vanilla"
  files={{
    '/index.html': `<!DOCTYPE html>
<html>
<head>
  <title>Weather App</title>
  <style>
    body { font-family: Arial; padding: 20px; max-width: 600px; margin: 0 auto; }
    input { padding: 10px; width: 60%; }
    button { padding: 10px 20px; }
    #weather { margin-top: 20px; padding: 20px; background: #f0f0f0; border-radius: 8px; }
    .temp { font-size: 48px; font-weight: bold; }
  </style>
</head>
<body>
  <h1>üå§Ô∏è Weather App</h1>
  <div>
    <input id="cityInput" placeholder="Enter city..." value="Moscow">
    <button onclick="getWeather()">Search</button>
  </div>
  <div id="weather"></div>
  <script src="index.js"></script>
</body>
</html>`,
    '/index.js': `const weatherDiv = document.getElementById('weather');
const cityInput = document.getElementById('cityInput');

// Mock weather data
const mockData = {
  'Moscow': { temp: -5, desc: 'Cloudy', humidity: 75 },
  'London': { temp: 8, desc: 'Rainy', humidity: 85 },
  'Tokyo': { temp: 12, desc: 'Sunny', humidity: 60 },
  'Default': { temp: 15, desc: 'Partly cloudy', humidity: 70 }
};

function getWeather() {
  const city = cityInput.value.trim() || 'Default';
  const data = mockData[city] || mockData['Default'];
  
  weatherDiv.innerHTML = \`
    <h2>\${city}</h2>
    <div class="temp">\${data.temp}¬∞C</div>
    <p>\${data.desc}</p>
    <p>Humidity: \${data.humidity}%</p>
  \`;
  
  console.log('Weather for', city, ':', data);
}

getWeather();`
  }}
/>

---

## –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏

‚ùå **"Cannot find module"**  
‚Üí –ü—Ä–æ–≤–µ—Ä—å –∏–º–ø–æ—Ä—Ç—ã ‚Äî –≤—Å–µ –¥–æ–ª–∂–Ω—ã –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è –Ω–∞ `.js` (–¥–∞–∂–µ –¥–ª—è `.ts` —Ñ–∞–π–ª–æ–≤!)

‚ùå **"API key invalid"**  
‚Üí –£–±–µ–¥–∏—Å—å —á—Ç–æ –≤—Å—Ç–∞–≤–∏–ª –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–ª—é—á –≤ `app.ts`

‚ùå **"Module not found in dist/"**  
‚Üí –ó–∞–ø—É—Å—Ç–∏ `npm run build` –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

‚ùå **"Type 'null' is not assignable..."**  
‚Üí TypeScript strict mode —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ null ‚Äî –¥–æ–±–∞–≤—å `!` –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫—É

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–î–æ–±–∞–≤—å –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ –Ω–µ–¥–µ–ª—é** (Forecast API)
2. **–ì—Ä–∞—Ñ–∏–∫–∏ –ø–æ–≥–æ–¥—ã** (Chart.js integration)
3. **–ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∏–∫–æ–Ω–∫–∏** (Lottie animations)
4. **Dark mode** (localStorage theme)
5. **–ò–∑–±—Ä–∞–Ω–Ω—ã–µ –≥–æ—Ä–æ–¥–∞** (save to LocalStorage)

---

**–ì–æ—Ç–æ–≤–æ! üéâ –¢–µ–ø–µ—Ä—å —É —Ç–µ–±—è –µ—Å—Ç—å TypeScript –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ production-—É—Ä–æ–≤–Ω—è!**
